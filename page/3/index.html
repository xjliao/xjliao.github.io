<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


  <meta name="google-site-verification" content="EiqhAXIfWx-Emrr55KP_eyNESxlj6jWXA4Xmac5S8sQ" />





  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.3"/>


    <meta name="description" content="A app & golang developer guy." />



  <meta name="keywords" content="xjliao.me" />



  <link rel="alternate" href="/atom.xml" title="xjliao" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.3" />



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    analytics: {
      google: 'UA-49849624-1'
    },
    sidebar: 'post'
  };
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?a5de7a16b42cff0e7c8add36f398ce48";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <title> xjliao </title>
</head>

<body>
  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">xjliao</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<div class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/">
            <i class="menu-item-icon icon-home"></i> <br />
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            <i class="menu-item-icon icon-archives"></i> <br />
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            <i class="menu-item-icon icon-categories"></i> <br />
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            <i class="menu-item-icon icon-tags"></i> <br />
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            <i class="menu-item-icon icon-about"></i> <br />
            About
          </a>
        </li>
      
    </ul>
  

  
</div>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <div id="posts" class="posts-expand">
    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/08/07/objective-c-nil-Nil-NULL-NSNull.html">
                Objective-c nil Nil NULL NSNull
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-08-07
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p><a href="http://nshipster.cn/nil/" target="_blank" rel="external">原文地址:http://nshipster.cn/nil/</a>  </p>
<p>相关文章: <a href="http://stackoverflow.com/questions/5908936/iphonedifference-between-nil-nil-and-null" target="_blank" rel="external">http://stackoverflow.com/questions/5908936/iphonedifference-between-nil-nil-and-null</a>  </p>
<p>理解“不存在”的概念不仅仅是一个哲学的问题，也是一个实际的问题。我们是有形宇宙的居民，而原因在于逻辑宇宙的存在不确定性。作为一个逻辑系统的物理体现，电脑面临一个棘手的问题，就是如何用存在表达不存在.</p>
<p>在Objective－C中，有几个不同种类的不存在。这样做的原因要追溯到一个频繁提及的NSHipster，讲解Objective-C如何在C的程序范例以及由Smalltalk启发的面向对象的范例中架起桥梁的。</p>
<p>C用0来作为不存在的原始值，而NULL作为指针(这在指针环境中相当于0)。</p>
<p>Objective-C在C的表达不存在的基础上增加了nil。nil是一个指向不存在的对象指针。虽然它在语义上与NULL不同，但它们在技术上是相等的。</p>
<p>在框架层面，Foundation定义了NSNull，即一个类方法+null，它返回一个单独的NSNull对象。NSNull与nil以及NULL不同，因为它是一个实际的对象，而不是一个零值。</p>
<p>另外，在Foundation/NSObjCRuntime.h中，Nil被定义为指向零的类指针。这个nil的鲜为人知的大写的表兄并不常常出现，但它至少值得注意。</p>
<p>关于 nil 的一些事</p>
<p>刚被分配的NSObject的内容被设置为0。也就是说那个对象所有的指向其他对象的指针都从nil开始，所以在init方法中设置self.(association) = nil之类的表达是没有必要的。</p>
<p>也许nil最显著的行为是，它虽然为零，仍然可以有消息发送给它。</p>
<p>在其他的语言中，比如C++，这样做会使你的程序崩溃，但在Objective-C中，在nil上调用方法返回一个零值。这大大的简化了表达，因为它避免了在使用nil之前对它的检查：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 举个例子，这个表达...</span></span><br><span class="line"><span class="keyword">if</span> (name != <span class="literal">nil</span> &amp;&amp; [name isEqualToString:<span class="string">@"Steve"</span>]) &#123; ... &#125;</span><br><span class="line"><span class="comment">// …可以被简化为：</span></span><br><span class="line"><span class="keyword">if</span> ([name isEqualToString:<span class="string">@"steve"</span>]) &#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>了解nil如何在Objective-C中工作可以让你将这个便利变成一个功能，而不是潜伏在你的应用中的bug。要确保避免当nil值不需要的情况，要么通过检查或者提前返回来安静的失败，或者通过增加一个NSParameterAssert来抛出异常。</p>
<p>NSNull：有作没有</p>
<p>NSNull在Foundation和其它框架中被广泛的使用，以解决如NSArray和NSDictionary之类的集合不能有nil值的缺陷。你可以将NSNull理解为有效的将NULL或者nil值封装boxing，以达到在集合中使用它们的目的：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableDictionary</span> *mutableDictionary = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line">mutableDictionary[<span class="string">@"someKey"</span>] = [<span class="built_in">NSNull</span> null]; <span class="comment">// Sets value of NSNull singleton for `someKey`</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"Keys: %@"</span>, [mutableDictionary allKeys]); <span class="comment">// @[@"someKey"]</span></span><br></pre></td></tr></table></figure>
<p>总的来说，这里的四个表达没有的值是每个Objective-C程序员都应该知道的:</p>
<table width="auto"><br>    <tr><br>        <th>标志</th><br>        <th>值</th><br>        <th>含义</th><br>    </tr><br>    <tr align="center"><br>        <td>NULL</td><br>        <td>(void *)0</td><br>        <td>C指针的字面零值</td><br>    </tr><br>    <tr align="center"><br>        <td>nil</td><br>        <td>(id)0</td><br>        <td>Objective-C对象的字面零值</td><br>    </tr><br>    <tr align="center"><br>        <td>Nil</td><br>        <td>(Class)0</td><br>        <td>Objective-C类的字面零值</td><br>    </tr><br>    <tr align="center"><br>        <td>NSNull</td><br>        <td>[NSNull null]</td><br>        <td>用来表示零值的单独的对象</td><br>    </tr><br></table>


        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/08/07/objective-c-error1.html">
                ERROR: after modifying system headers, please delete the module cache at
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-08-07
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fatal error: file <span class="string">'/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.9.sdk/System/Library/Frameworks/Foundation.framework/Headers/NSObject.h'</span> has been modified since the precompiled header <span class="string">'/Users/xjliao/Library/Developer/Xcode/DerivedData/ModuleCache/3DW0I404IQ8ZW/Foundation.pcm'</span> was built</span><br><span class="line">note: after modifying system headers, please delete the module cache at <span class="string">'/Users/xjliao/Library/Developer/Xcode/DerivedData/ModuleCache/3DW0I404IQ8ZW'</span></span><br><span class="line"><span class="number">5</span> warnings and <span class="number">1</span> error generated.</span><br></pre></td></tr></table></figure>
<p>解决方案:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.rm -rf /Users/xjliao/Library/Developer/Xcode/DerivedData/ModuleCache/*  </span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.Product -&gt; Clean。(这时上述文件夹中将重新生成系统SDK的数据)</span><br></pre></td></tr></table></figure></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/08/07/objective-c-block.html">
                Objective-c block
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-08-07
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p><a href="http://fuckingblocksyntax.com/" target="_blank" rel="external">原文地址:http://fuckingblocksyntax.com/</a></p>
<p>How Do I Declare A Block in Objective-C?  </p>
<p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//局部量</span></span><br><span class="line">returnType (^blockName)(parameterTypes) = ^returnType(parameters) &#123;...&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//property属性</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) returnType (^blockName)(parameterTypes);</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法参数</span></span><br><span class="line">- (<span class="keyword">void</span>)someMethodThatTakesABlock:(returnType (^)(parameterTypes))blockName;</span><br><span class="line"></span><br><span class="line"><span class="comment">//作为参数被方法调用</span></span><br><span class="line">[someObject someMethodThatTakesABlock: ^returnType (parameters) &#123;...&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">//typdef</span></span><br><span class="line"><span class="keyword">typedef</span> returnType (^TypeName)(parameterTypes);</span><br><span class="line">TypeName blockName = ^returnType(parameters) &#123;...&#125;;</span><br></pre></td></tr></table></figure>.</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/07/26/linux-ddos-defense.html">
                Linux ddos defense
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-07-26
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Linux/">Linux</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p><a href="http://deflate.medialayer.com/" target="_blank" rel="external">官网:http://deflate.medialayer.com/</a></p>
<h2 id="About">About</h2><p>(D)DoS Deflate is a lightweight bash shell script designed to assist in the process of blocking a denial of service attack. It utilizes the command below to create a list of IP addresses connected to the server, along with their total number of connections. It is one of the simplest and easiest to install solutions at the software level.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ntu | awk <span class="string">'&#123;print $5&#125;'</span> | cut <span class="operator">-d</span>: <span class="operator">-f</span>1 | sort | uniq -c | sort -n</span><br></pre></td></tr></table></figure>
<p>IP addresses with over a pre-configured number of connections are automatically blocked in the server’s firewall, which can be direct iptables or Advanced Policy Firewall (APF). (We highly recommend that you use APF on your server in general, but deflate will work without it.)</p>
<h2 id="Notable_Features">Notable Features</h2><p>It is possible to whitelist IP addresses, via /usr/local/ddos/ignore.ip.list.<br>Simple configuration file: /usr/local/ddos/ddos.conf<br>IP addresses are automatically unblocked after a preconfigured time limit (default: 600 seconds)<br>The script can run at a chosen frequency via the configuration file (default: 1 minute)<br>You can receive email alerts when IP addresses are blocked.</p>
<h2 id="Installation">Installation</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.inetbase.com/scripts/ddos/install.sh</span><br><span class="line">chmod <span class="number">0700</span> install.sh</span><br><span class="line">./install.sh</span><br></pre></td></tr></table></figure>
<h2 id="Uninstallation">Uninstallation</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.inetbase.com/scripts/ddos/uninstall.ddos</span><br><span class="line">chmod <span class="number">0700</span> uninstall.ddos</span><br><span class="line">./uninstall.ddos</span><br></pre></td></tr></table></figure>
<h2 id="Questions?">Questions?</h2><p>Although most things are explained on this page, if you have any further questions, you may contact the original developer of the script, Zaf.</p>
<h2 id="Ban_ping">Ban ping</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p icmp --icmp-type <span class="number">8</span> <span class="operator">-s</span> <span class="number">0</span>/<span class="number">0</span> -j DROP</span><br></pre></td></tr></table></figure>
<h2 id="Allow_ping">Allow ping</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -D INPUT -p icmp --icmp-type <span class="number">8</span> <span class="operator">-s</span> <span class="number">0</span>/<span class="number">0</span> -j DROP</span><br></pre></td></tr></table></figure>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/07/16/ios-uipickerview.html">
                Ios UIPickerView demo
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-07-16
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Ios/">Ios</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>关键点:</p>
<h2 id="需实现这两个协议">需实现<uipickerviewdatasource, uipickerviewdelegate="">这两个协议</uipickerviewdatasource,></h2><h3 id="UIPickerViewDataSource需要实现的方法:">UIPickerViewDataSource需要实现的方法:</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置选择框的个数  </span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)numberOfComponentsInPickerView:(<span class="built_in">UIPickerView</span> *)pickerView  </span><br><span class="line">&#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="number">2</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">//设置每个选择框的数量  </span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)pickerView:(<span class="built_in">UIPickerView</span> *)pickerView numberOfRowsInComponent:(<span class="built_in">NSInteger</span>)component &#123;  </span><br><span class="line">    <span class="keyword">if</span> (component == kStateComponent) &#123;  </span><br><span class="line">            <span class="keyword">return</span> [[<span class="keyword">self</span> provinces] count];  </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> [[<span class="keyword">self</span> countrys] count];  </span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 
<h3 id="UIPickerViewDelegate需要实现的方法:">UIPickerViewDelegate需要实现的方法:</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置每个选择框的内容  </span></span><br><span class="line">- (<span class="built_in">NSString</span> *)pickerView:(<span class="built_in">UIPickerView</span> *)pickerView titleForRow:(<span class="built_in">NSInteger</span>)row forComponent:(<span class="built_in">NSInteger</span>)component &#123;</span><br><span class="line">    <span class="keyword">if</span> (component == kStateComponent) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span><span class="variable">.provinces</span>[row];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span><span class="variable">.countrys</span>[row];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">//可选实现方法，自定义picker 显示图片</span></span><br><span class="line">- (<span class="built_in">UIView</span> *)pickerView:(<span class="built_in">UIPickerView</span> *)pickerView viewForRow:(<span class="built_in">NSInteger</span>)row forComponent:(<span class="built_in">NSInteger</span>)component reusingView:(<span class="built_in">UIView</span> *)view</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIImage</span> *image = <span class="keyword">self</span><span class="variable">.images</span>[row];</span><br><span class="line">    <span class="built_in">UIImageView</span> *imageView = [[<span class="built_in">UIImageView</span> alloc] initWithImage:image];</span><br><span class="line">    <span class="keyword">return</span> imageView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="以下是demo">以下是demo</h2><h3 id="依赖选择，联动">依赖选择，联动</h3><p>BIDDependentPickerViewController.h  </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BIDDependentPickerViewController.h</span></span><br><span class="line"><span class="comment">//  Pickers</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-7-1.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjl. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#define kStateComponent 0</span></span><br><span class="line"><span class="preprocessor">#define kZipComponent 1</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BIDDependentPickerViewController</span> : <span class="title">UIViewController</span> &lt;<span class="title">UIPickerViewDataSource</span>, <span class="title">UIPickerViewDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIPickerView</span> *dependentPicker;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIButton</span> *btn;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSDictionary</span> *provinceDics;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSArray</span> *provinces;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSArray</span> *countrys;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@property (strong, nonatomic) NSDictionary *stateZips;</span></span><br><span class="line"><span class="comment">//@property (strong, nonatomic) NSArray *states;</span></span><br><span class="line"><span class="comment">//@property (strong, nonatomic) NSArray *zips;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnPressed;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>BIDDependentPickerViewController.m  </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BIDDependentPickerViewController.m</span></span><br><span class="line"><span class="comment">//  Pickers</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-7-1.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjl. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"BIDDependentPickerViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BIDDependentPickerViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BIDDependentPickerViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)initWithNibName:(<span class="built_in">NSString</span> *)nibNameOrNil bundle:(<span class="built_in">NSBundle</span> *)nibBundleOrNil</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithNibName:nibNameOrNil bundle:nibBundleOrNil];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// Custom initialization</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="built_in">UIButton</span> *btn = [[<span class="built_in">UIButton</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">150</span>, <span class="number">300</span>, <span class="number">100</span>, <span class="number">100</span>)];</span><br><span class="line">    [btn setTitle:<span class="string">@"单击"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [btn setTitleColor:[<span class="built_in">UIColor</span> redColor] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:btn];</span><br><span class="line">    [btn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnPressed) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSBundle</span> *boundle = [<span class="built_in">NSBundle</span> mainBundle];</span><br><span class="line">    <span class="built_in">NSURL</span> *plistURL = [boundle URLForResource:<span class="string">@"statedictionary"</span> withExtension:<span class="string">@"plist"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span><span class="variable">.provinceDics</span> = [<span class="built_in">NSDictionary</span> dictionaryWithContentsOfURL:plistURL];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSArray</span> *allprovinces = [<span class="keyword">self</span><span class="variable">.provinceDics</span> allKeys];</span><br><span class="line">    <span class="built_in">NSArray</span> *sortedprovinces = [allprovinces sortedArrayUsingSelector:<span class="keyword">@selector</span>(compare:)];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span><span class="variable">.provinces</span> = sortedprovinces;</span><br><span class="line">    <span class="built_in">NSString</span> *selectedState = <span class="keyword">self</span><span class="variable">.provinces</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.countrys</span> = <span class="keyword">self</span><span class="variable">.provinceDics</span>[selectedState];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> didReceiveMemoryWarning];</span><br><span class="line">    <span class="comment">// Dispose of any resources that can be recreated.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//每个选择组件里的内容的数量</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)pickerView:(<span class="built_in">UIPickerView</span> *)pickerView numberOfRowsInComponent:(<span class="built_in">NSInteger</span>)component &#123;</span><br><span class="line">    <span class="keyword">if</span> (component == kStateComponent) &#123;</span><br><span class="line">        <span class="keyword">return</span> [[<span class="keyword">self</span> provinces] count];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> [[<span class="keyword">self</span> countrys] count];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//选择组件的数量，多少个选择项</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)numberOfComponentsInPickerView:(<span class="built_in">UIPickerView</span> *)pickerView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//选择组件的内容</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)pickerView:(<span class="built_in">UIPickerView</span> *)pickerView titleForRow:(<span class="built_in">NSInteger</span>)row forComponent:(<span class="built_in">NSInteger</span>)component &#123;</span><br><span class="line">    <span class="keyword">if</span> (component == kStateComponent) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span><span class="variable">.provinces</span>[row];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span><span class="variable">.countrys</span>[row];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnPressed &#123;</span><br><span class="line">    <span class="built_in">NSInteger</span> stateRow = [<span class="keyword">self</span><span class="variable">.dependentPicker</span> selectedRowInComponent:kStateComponent];</span><br><span class="line">    <span class="built_in">NSInteger</span> zipRow = [<span class="keyword">self</span><span class="variable">.dependentPicker</span> selectedRowInComponent:kZipComponent];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *state = <span class="keyword">self</span><span class="variable">.provinces</span>[stateRow];</span><br><span class="line">    <span class="built_in">NSString</span> *zip = <span class="keyword">self</span><span class="variable">.countrys</span>[zipRow];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *title = [[<span class="built_in">NSString</span> alloc] initWithFormat:<span class="string">@"你选择的省分为:%@"</span>, state];</span><br><span class="line">    <span class="built_in">NSString</span> *msg = [[<span class="built_in">NSString</span> alloc] initWithFormat:<span class="string">@"你选择的省份:%@, 城市:%@"</span>, state, zip];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIAlertView</span> *alertView = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:title message:msg delegate:<span class="literal">nil</span> cancelButtonTitle:<span class="string">@"取消"</span> otherButtonTitles:<span class="literal">nil</span>, <span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    [alertView show];</span><br><span class="line"><span class="comment">//    </span></span><br><span class="line"><span class="comment">//    UIAlertView *uav = [[UIAlertView alloc] initWithTitle:@"fdojf" message:@"Nothing" delegate:nil cancelButtonTitle:@"cancle" otherButtonTitles:nil, nil];</span></span><br><span class="line"><span class="comment">//    [uav show];</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//拖动左边的齿轮时，右边的数据相应的Reload更新</span></span><br><span class="line">- (<span class="keyword">void</span>)pickerView:(<span class="built_in">UIPickerView</span> *)pickerView didSelectRow:(<span class="built_in">NSInteger</span>)row inComponent:(<span class="built_in">NSInteger</span>)component</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (component == kStateComponent) &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *selectedState = <span class="keyword">self</span><span class="variable">.provinces</span>[row];</span><br><span class="line">        <span class="keyword">self</span><span class="variable">.countrys</span> = <span class="keyword">self</span><span class="variable">.provinceDics</span>[selectedState];</span><br><span class="line">        [<span class="keyword">self</span><span class="variable">.dependentPicker</span> reloadComponent:kZipComponent];</span><br><span class="line">        [<span class="keyword">self</span><span class="variable">.dependentPicker</span> selectRow:<span class="number">0</span> inComponent:kZipComponent animated:<span class="literal">YES</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">#pragma mark - Navigation</span><br><span class="line"></span><br><span class="line">// In a storyboard-based application, you will often want to do a little preparation before navigation</span><br><span class="line">- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    // Get the new view controller using [segue destinationViewController].</span><br><span class="line">    // Pass the selected object to the new view controller.</span><br><span class="line">&#125;</span><br><span class="line">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="自定义UIPickerView">自定义UIPickerView</h3><p>BIDCustomPickerViewController.h  </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BIDCustomPickerViewController.h</span></span><br><span class="line"><span class="comment">//  Pickers</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-7-1.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjl. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BIDCustomPickerViewController</span> : <span class="title">UIViewController</span>&lt;<span class="title">UIPickerViewDataSource</span>, <span class="title">UIPickerViewDelegate</span>, <span class="title">UIAlertViewDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIPickerView</span> *picker;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIButton</span> *btn;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UILabel</span> *winLabel;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSArray</span> *images;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnPressed;</span><br><span class="line">- (<span class="keyword">void</span>)spin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>BIDCustomPickerViewController.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  BIDCustomPickerViewController.m</span></span><br><span class="line"><span class="comment">//  Pickers</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-7-1.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjl. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"BIDCustomPickerViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BIDCustomPickerViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BIDCustomPickerViewController</span></span></span><br><span class="line"><span class="keyword">@synthesize</span> picker, btn, images, winLabel;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)loadView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIView</span> *view = [[<span class="built_in">UIView</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] applicationFrame]];</span><br><span class="line">    view<span class="variable">.backgroundColor</span> = [<span class="built_in">UIColor</span> blueColor];</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.view</span> = view;</span><br><span class="line">    [view release];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">super</span> loadView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)initWithNibName:(<span class="built_in">NSString</span> *)nibNameOrNil bundle:(<span class="built_in">NSBundle</span> *)nibBundleOrNil</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithNibName:nibNameOrNil bundle:nibBundleOrNil];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// Custom initialization</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view.</span></span><br><span class="line">    btn = [[<span class="built_in">UIButton</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">150</span>, <span class="number">150</span>, <span class="number">100</span>, <span class="number">100</span>)];</span><br><span class="line">    [btn setTitle:<span class="string">@"按我啊"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [btn setTitleColor:[<span class="built_in">UIColor</span> greenColor] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [btn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnPressed) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:btn];</span><br><span class="line">    </span><br><span class="line">    winLabel = [[<span class="built_in">UILabel</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">200</span>, <span class="number">200</span>, <span class="number">100</span>, <span class="number">100</span>)];</span><br><span class="line">    [winLabel setTextColor:[<span class="built_in">UIColor</span> redColor]];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:winLabel];</span><br><span class="line">    </span><br><span class="line">    picker = [[<span class="built_in">UIPickerView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>, <span class="number">200</span>)];</span><br><span class="line">    picker<span class="variable">.dataSource</span> = <span class="keyword">self</span>;</span><br><span class="line">    picker<span class="variable">.delegate</span> = <span class="keyword">self</span>;</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:picker];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span><span class="variable">.images</span> = @[[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Custom"</span>], [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Date"</span>],</span><br><span class="line">                    [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Dependent"</span>], [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Double"</span>],</span><br><span class="line">                    [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Single"</span>]];</span><br><span class="line">    </span><br><span class="line">    srandom(time(<span class="literal">NULL</span>));</span><br><span class="line"><span class="comment">//    picker</span></span><br><span class="line"><span class="comment">//    []</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSInteger</span>)numberOfComponentsInPickerView:(<span class="built_in">UIPickerView</span> *)pickerView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span><span class="variable">.images</span> count];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSInteger</span>)pickerView:(<span class="built_in">UIPickerView</span> *)pickerView numberOfRowsInComponent:(<span class="built_in">NSInteger</span>)component</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span><span class="variable">.images</span> count];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//picker 显示图片</span></span><br><span class="line">- (<span class="built_in">UIView</span> *)pickerView:(<span class="built_in">UIPickerView</span> *)pickerView viewForRow:(<span class="built_in">NSInteger</span>)row forComponent:(<span class="built_in">NSInteger</span>)component reusingView:(<span class="built_in">UIView</span> *)view</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIImage</span> *image = <span class="keyword">self</span><span class="variable">.images</span>[row];</span><br><span class="line">    <span class="built_in">UIImageView</span> *imageView = [[<span class="built_in">UIImageView</span> alloc] initWithImage:image];</span><br><span class="line">    <span class="keyword">return</span> imageView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> didReceiveMemoryWarning];</span><br><span class="line">    <span class="comment">// Dispose of any resources that can be recreated.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnPressed</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span> spin];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)spin</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">BOOL</span> win = <span class="literal">NO</span>;</span><br><span class="line">    <span class="keyword">int</span> numInRow = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> lastVal = -<span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> newValue = random() % [<span class="keyword">self</span><span class="variable">.images</span> count];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (newValue == lastVal) &#123;</span><br><span class="line">            numInRow++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            numInRow = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        lastVal = newValue;</span><br><span class="line">        </span><br><span class="line">        [<span class="keyword">self</span><span class="variable">.picker</span> selectRow:newValue inComponent:i animated:<span class="literal">YES</span>];</span><br><span class="line">        [<span class="keyword">self</span><span class="variable">.picker</span> reloadComponent:i];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (numInRow &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">            win = <span class="literal">YES</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (win) &#123;</span><br><span class="line">            <span class="keyword">self</span><span class="variable">.winLabel</span><span class="variable">.text</span> = <span class="string">@"恭喜您，赢了！"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span><span class="variable">.winLabel</span><span class="variable">.text</span> = <span class="string">@"很遗憾，就差一点了，不要灰心，继续努力"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span><br><span class="line">#pragma mark - Navigation</span><br><span class="line"></span><br><span class="line">// In a storyboard-based application, you will often want to do a little preparation before navigation</span><br><span class="line">- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    // Get the new view controller using [segue destinationViewController].</span><br><span class="line">    // Pass the selected object to the new view controller.</span><br><span class="line">&#125;</span><br><span class="line">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/07/11/python-demo-get-nu.html">
                Python 抓取某通信号码
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-07-11
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Python/">Python</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>Python抓取某通信号码  </p>
<p>code_zh.txt 内容格式：省编码-城市编码:省名-城市名 每行一条记录<br>code_en.txt 内容格式和code_zh一样，中文改为汉语拼音即可,例如:11-1101:BeiJing-BeiJing  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11</span>-<span class="number">1101</span>:北京市-北京市</span><br><span class="line"><span class="number">31</span>-<span class="number">3101</span>:上海市-上海市</span><br><span class="line"><span class="number">32</span>-<span class="number">3201</span>:江苏省-南京市</span><br><span class="line"><span class="number">32</span>-<span class="number">3202</span>:江苏省-无锡市</span><br><span class="line"><span class="number">32</span>-<span class="number">3203</span>:江苏省-徐州市</span><br><span class="line"><span class="number">32</span>-<span class="number">3205</span>:江苏省-苏州市</span><br><span class="line"><span class="number">32</span>-<span class="number">3209</span>:江苏省-盐城市</span><br><span class="line"><span class="number">33</span>-<span class="number">3301</span>:浙江省-杭州市</span><br><span class="line"><span class="number">33</span>-<span class="number">3302</span>:浙江省-宁波市</span><br><span class="line"><span class="number">33</span>-<span class="number">3303</span>:浙江省-温州市</span><br><span class="line"><span class="number">33</span>-<span class="number">3307</span>:浙江省-金华市</span><br><span class="line"><span class="number">33</span>-<span class="number">3310</span>:浙江省-台州市</span><br><span class="line"><span class="number">44</span>-<span class="number">4401</span>:广东省-广州市</span><br><span class="line"><span class="number">44</span>-<span class="number">4403</span>:广东省-深圳市</span><br><span class="line"><span class="number">44</span>-<span class="number">4404</span>:广东省-珠海市</span><br><span class="line"><span class="number">44</span>-<span class="number">4406</span>:广东省-佛山市</span><br><span class="line"><span class="number">44</span>-<span class="number">4413</span>:广东省-惠州市</span><br><span class="line"><span class="number">44</span>-<span class="number">4419</span>:广东省-东莞市</span><br><span class="line"><span class="number">44</span>-<span class="number">4420</span>:广东省-中山市</span><br><span class="line"><span class="number">50</span>-<span class="number">5001</span>:重庆市-重庆市</span><br></pre></td></tr></table></figure>
<p>send.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Test 数据</span></span><br><span class="line"><span class="comment"># proDics = &#123;"32":"JiangSu"&#125;;</span></span><br><span class="line"><span class="comment"># codeDics = [&#123;"32":"3201"&#125; ,&#123;"32":"3202"&#125;]</span></span><br><span class="line"><span class="comment"># cityDics = &#123;"323201":"NanJing", "323202":"XuZhou"&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从文件读取省，城市编码</span></span><br><span class="line"><span class="comment"># 格式为：省编码-城市编码：省名称-城市名称</span></span><br><span class="line">codeFile = open(<span class="string">'code_zh.txt'</span>, <span class="string">'r'</span>)</span><br><span class="line"><span class="comment">#print f.readlines()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 存放省编码，地市编码，省包含的地市编码</span></span><br><span class="line"><span class="comment"># 格式为如下</span></span><br><span class="line"><span class="comment"># 省：proDics = &#123;"省编码":"省名称"&#125;</span></span><br><span class="line"><span class="comment"># 省包含的城市编码,一个省有多个地市：codeDics = [&#123;"省编码":"城市编码1"&#125;，&#123;"省编码":"城市编码2"&#125;]</span></span><br><span class="line"><span class="comment"># 城市：cityDics = &#123;"省编码 + 城市编码":"城市名称"&#125;</span></span><br><span class="line">proDics = &#123;&#125;</span><br><span class="line">codeDics = []</span><br><span class="line">cityDics = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历文件文件中的数据</span></span><br><span class="line"><span class="comment"># code 为文件中的每行数据, 格式:省编码-城市编码:省名称-城市名称</span></span><br><span class="line"><span class="keyword">for</span> code <span class="keyword">in</span> codeFile.readlines():</span><br><span class="line">	<span class="comment"># f为将省编码-城市编码:省名称-城市名称以':'分割</span></span><br><span class="line">	f = code.split(<span class="string">':'</span>)</span><br><span class="line">	<span class="comment"># f1为省编码-城市编码以'-'分割的数组，0为省编码，1为城市编码</span></span><br><span class="line">	f1 = f[<span class="number">0</span>].split(<span class="string">'-'</span>)</span><br><span class="line">	<span class="comment"># f1为省名称-城市名称以'-'分割的数组，0为省名称，1为城市名称</span></span><br><span class="line">	f2 = f[<span class="number">1</span>].split(<span class="string">'-'</span>)</span><br><span class="line">	<span class="comment"># 获取f1里的省编码</span></span><br><span class="line">	proCode = f1[<span class="number">0</span>]</span><br><span class="line">	<span class="comment"># 获取f2里面的省名称</span></span><br><span class="line">	proName = f2[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 存入省字典</span></span><br><span class="line">	proDics[proCode] = proName</span><br><span class="line">	<span class="comment"># 城市编码为f里0下标去掉-</span></span><br><span class="line">	cityCode = f1[<span class="number">1</span>]</span><br><span class="line">	<span class="comment"># 城市名称为f2里1下标的内容，\n为文件内容的换行符，需去掉</span></span><br><span class="line">	cityName = f2[<span class="number">1</span>].replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 存入城市字典</span></span><br><span class="line">	cityDics[cityCode] = cityName</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 省编码包含的城市编码</span></span><br><span class="line">	codeDic = &#123;&#125;</span><br><span class="line">	codeDic[proCode] = cityCode</span><br><span class="line">	codeDics.append(codeDic)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print proDics</span></span><br><span class="line"><span class="comment">#print cityDics</span></span><br><span class="line"><span class="comment">#print codeDics	</span></span><br><span class="line"><span class="keyword">if</span> (<span class="number">1</span> &lt; <span class="number">2</span>):</span><br><span class="line">	<span class="comment"># codeDic为某个省包含的城市编码字典</span></span><br><span class="line">	<span class="keyword">for</span> codeDic <span class="keyword">in</span> codeDics:</span><br><span class="line">		<span class="comment"># codeKey=省编码，codeVal=城市编码</span></span><br><span class="line">		<span class="keyword">for</span> (codeKey, codeVal) <span class="keyword">in</span> codeDic.items():</span><br><span class="line">			<span class="comment"># 省名称</span></span><br><span class="line">			proName = proDics[codeKey]</span><br><span class="line">			<span class="comment"># 获取城市名称</span></span><br><span class="line">			city = cityDics[codeVal]</span><br><span class="line">			<span class="comment"># fName存放原始内容</span></span><br><span class="line">			<span class="comment"># newFName存放去重后的内容</span></span><br><span class="line">			<span class="comment"># allFname存放去重后的排序内容</span></span><br><span class="line">			fName = proName + <span class="string">'-'</span> + city + <span class="string">'-1.txt'</span></span><br><span class="line">			newFName = proName + <span class="string">'-'</span> + city + <span class="string">'-2.txt'</span></span><br><span class="line">			allFName = proName + <span class="string">'-'</span> + city + <span class="string">'.txt'</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (os.path.isfile(allFName)):</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">			<span class="comment"># 循环次数为n次，所以要追加到文件内容末尾</span></span><br><span class="line">			f = open(fName, <span class="string">'ar'</span>)</span><br><span class="line">			<span class="keyword">print</span> <span class="string">'  '</span> + city</span><br><span class="line">			<span class="comment"># curl为shell命令，访问链接</span></span><br><span class="line">			<span class="comment"># 靓号链接</span></span><br><span class="line">			cmd = <span class="string">"curl 'http://detailskip.taobao.com/json/dyn_combo.do?provCode="</span> + codeKey + <span class="string">"&amp;regionCode="</span> + codeVal + <span class="string">"&amp;model=WCDMA&amp;like=&amp;_tb_token_=07VtqGi1U9Va&amp;_input_charset=UTF-8&amp;_ksTS=1405003247995_1220&amp;callback=jsonp1221&amp;itemId=39865087221&amp;databiz=telenum&amp;numtype=contract&amp;telecomId=39865087221' -H 'Host: detailskip.taobao.com' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0) Gecko/20100101 Firefox/30.0' -H 'Accept: */*' -H 'Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3' -H 'Accept-Encoding: gzip, deflate' -H 'Referer: http://detail.aliqin.tmall.com/item.htm?spm=a1z2p.7360257.1997908701.12.FhZgKg&amp;id=39865087221' -H 'Cookie: t=8176bd32cdb49af344b553b788b17784; cna=X3sXDFeu8WkCAZkDKBPAs7u8; uc3=nk2=&amp;id2=&amp;lg2=; tracknick=; _cc_=WqG3DMC9EA%3D%3D; tg=0; l=suplxj::1402643332571::11; lzstat_uv=241936811430198200|2185014; mt=ci=0_0; ck1=; _tb_token_=07VtqGi1U9Va; cookie2=99aedc28164de90d0fc6cda889928a8b; uc1=cookie14=UoW3uiiZyW5nQg%3D%3D; v=0' -H 'Connection: keep-alive'"</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment"># 普通号</span></span><br><span class="line">			<span class="comment">#cmd = "curl 'http://detailskip.taobao.com/json/dyn_combo.do?provCode=" + codeKey + "&amp;regionCode=" + codeVal + "&amp;model=WCDMA&amp;like=&amp;_tb_token_=07VtqGi1U9Va&amp;_input_charset=UTF-8&amp;_ksTS=1404996627874_3462&amp;callback=jsonp3463&amp;itemId=39990583842&amp;databiz=telenum&amp;numtype=main&amp;telecomId=39990583842&amp;offerId=111050001001' -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3' -H 'Connection: keep-alive' -H 'Cookie: t=8176bd32cdb49af344b553b788b17784; cna=X3sXDFeu8WkCAZkDKBPAs7u8; uc3=nk2=&amp;id2=&amp;lg2=; tracknick=; _cc_=WqG3DMC9EA%3D%3D; tg=0; l=suplxj::1402643332571::11; lzstat_uv=241936811430198200|2185014; mt=ci=0_0; ck1=; _tb_token_=07VtqGi1U9Va; cookie2=99aedc28164de90d0fc6cda889928a8b; uc1=cookie14=UoW3u5tb66%2BGhg%3D%3D; v=0' -H 'Host: detailskip.taobao.com' -H 'Referer: http://detail.aliqin.tmall.com/item.htm?spm=a1z2p.7360289.0.0.P5qmke&amp;id=39990583842' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0) Gecko/20100101 Firefox/30.0'"</span></span><br><span class="line">						</span><br><span class="line">			<span class="comment"># 访问次链接n次</span></span><br><span class="line">			n = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> proName == <span class="string">'北京市'</span>:</span><br><span class="line">				n = n / <span class="number">2</span></span><br><span class="line">			<span class="keyword">elif</span> proName == <span class="string">'上海市'</span>:</span><br><span class="line">				n = n / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">1</span>, n):</span><br><span class="line">				<span class="keyword">print</span> x</span><br><span class="line">				<span class="keyword">print</span> proName</span><br><span class="line">				<span class="keyword">print</span> <span class="string">'  '</span> + city</span><br><span class="line">				<span class="comment"># 执行访问命令, popen返回执行结果内容文件对象，system只返回执行后的状态0，1等	</span></span><br><span class="line">				returnFile = os.popen(cmd)</span><br><span class="line">				<span class="comment"># 读取返回的内容</span></span><br><span class="line">				fileContent = returnFile.read();</span><br><span class="line">				<span class="comment"># 处理返回内容</span></span><br><span class="line">				beginIndex = fileContent.index(<span class="string">'['</span>)</span><br><span class="line">				endIndex = fileContent.index(<span class="string">']'</span>)</span><br><span class="line"></span><br><span class="line">				phoneNumbers = fileContent[beginIndex + <span class="number">1</span>:endIndex]</span><br><span class="line">				phoneNumbers = phoneNumbers.replace(<span class="string">'"'</span>, <span class="string">""</span>)</span><br><span class="line">				phoneNumbers = phoneNumbers.split(<span class="string">','</span>)</span><br><span class="line"></span><br><span class="line">				<span class="comment"># 排序</span></span><br><span class="line">				phoneNumbers.sort()</span><br><span class="line"></span><br><span class="line">				<span class="comment"># 遍历每个号码，并存文件</span></span><br><span class="line">				<span class="keyword">for</span> phoneNumber <span class="keyword">in</span> phoneNumbers:</span><br><span class="line">					f.write(phoneNumber + <span class="string">'\n'</span>)</span><br><span class="line">					<span class="keyword">print</span> phoneNumber</span><br><span class="line"></span><br><span class="line">			f.close()</span><br><span class="line"></span><br><span class="line">			<span class="comment"># 去掉重复的号码， 使用set， 集合是无重复，无序的数据结果，并保存到另外一个文件</span></span><br><span class="line">			newF = open(newFName, <span class="string">'w'</span>)</span><br><span class="line">			fr = open(fName, <span class="string">'r'</span>)</span><br><span class="line">			newF.write(<span class="string">''</span>.join(set(fr.readlines())))</span><br><span class="line">			fr.close()</span><br><span class="line">			newF.close()</span><br><span class="line"></span><br><span class="line">			<span class="comment"># 对去重之后的数据进行排序， 并存入一个新文件</span></span><br><span class="line">			newFr = open(newFName, <span class="string">'r'</span>)	</span><br><span class="line">			allNumber =  newFr.readlines()</span><br><span class="line">			allNumber.sort()</span><br><span class="line">			fAllNumber = open(allFName, <span class="string">'w'</span>)</span><br><span class="line">			newFr.close()</span><br><span class="line"></span><br><span class="line">			<span class="comment"># 遍历去重之后的号码，写入文件</span></span><br><span class="line">			<span class="keyword">for</span> num <span class="keyword">in</span> allNumber:</span><br><span class="line">				fAllNumber.write(num)</span><br><span class="line"></span><br><span class="line">			fAllNumber.close()</span><br><span class="line">			<span class="comment"># 删除去重后的文件，只保留去重后，排序过的文件</span></span><br><span class="line">			os.remove(newFName)</span><br><span class="line">			<span class="comment"># 删除原始内容文件</span></span><br><span class="line">			os.remove(fName)</span><br></pre></td></tr></table></figure>
<p>最后结果的出入文件名为每个省，城市独立文件存储，格式:省名称-城市名称.txt，例如:江苏省-南京市</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/31/IOS_1.html">
                Ios关闭键盘
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-31
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Ios/">Ios</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>虚拟键盘是要有编辑属性的控件才会出现</p>
<p>BIDViewController.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"BIDViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BIDViewController</span> ()</span></span><br><span class="line"><span class="comment">//将下列Outlet，ibaction放到.h文件也也可以。</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UITextField</span> *numberField;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UITextField</span> *nameField;</span><br><span class="line">- (<span class="keyword">IBAction</span>)textFiledDidEndEdit:(<span class="built_in">UITextField</span> *)sender;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BIDViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)initWithNibName:(<span class="built_in">NSString</span> *)nibNameOrNil bundle:(<span class="built_in">NSBundle</span> *)nibBundleOrNil</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithNibName:nibNameOrNil bundle:nibBundleOrNil];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// Custom initialization</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view from its nib.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> didReceiveMemoryWarning];</span><br><span class="line">    <span class="comment">// Dispose of any resources that can be recreated.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*点击虚拟键盘Done键关闭键盘 关联xib文件UITextField的，</span><br><span class="line">将did end on exit 绑定到下列方法，</span><br><span class="line">但好像不用[sender resignFirstResponder]也可以关闭键盘。*/</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)textFiledDidEndEdit:(<span class="built_in">UITextField</span> *)sender &#123;</span><br><span class="line">    [sender resignFirstResponder];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//单击按钮关闭键盘</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)btnPress:(<span class="keyword">id</span>)sender</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.nameField</span> resignFirstResponder];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.numberField</span> resignFirstResponder];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*单击屏幕任意处关闭键盘,将xib文件里最底层整个View的类型改为</span><br><span class="line">UIControl类，然后将touch down事件绑定为下面这个方法*/</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)backgroundTap:(<span class="keyword">id</span>)sender</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.nameField</span> resignFirstResponder];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.numberField</span> resignFirstResponder];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/30/IOS_1.html">
                Ios纯代码创建view
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-30
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Ios/">Ios</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="demo1">demo1</h2><blockquote>
<p>代码创建,无nib，xib，storyboard文件，纯代码 </p>
</blockquote>
<h3 id="main-m">main.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  main.m</span></span><br><span class="line"><span class="comment">//  Test</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-29.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 ___FULLUSERNAME___. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"xjlAppDelegate.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">UIApplicationMain</span>(argc, argv, <span class="literal">nil</span>, <span class="built_in">NSStringFromClass</span>([xjlAppDelegate class]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="xjlAppDelegate-h">xjlAppDelegate.h</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  xjlAppDelegate.h</span></span><br><span class="line"><span class="comment">//  Test</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-29.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 ___FULLUSERNAME___. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">xjlAppDelegate</span> : <span class="title">UIResponder</span> &lt;<span class="title">UIApplicationDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIWindow</span> *window;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="xjlAppDelegate-m">xjlAppDelegate.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"xjlAppDelegate.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"MyViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">xjlAppDelegate</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.window</span> = [[<span class="built_in">UIWindow</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] bounds]];</span><br><span class="line">    <span class="comment">// Override point for customization after application launch.</span></span><br><span class="line">    <span class="keyword">self</span><span class="variable">.window</span><span class="variable">.backgroundColor</span> = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">    MyViewController *ss;</span><br><span class="line">    ss = [[MyViewController alloc] init];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.window</span> addSubview:ss<span class="variable">.view</span>];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.window</span> makeKeyAndVisible];</span><br><span class="line">    <span class="comment">//不能直接[ss release] 会报错, [ss.view release]可以</span></span><br><span class="line">    [ss<span class="variable">.view</span> release];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="MyViewController-h">MyViewController.h</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  MyViewController.h</span></span><br><span class="line"><span class="comment">//  Test</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-29.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyViewController</span> : <span class="title">UIViewController</span> &lt;<span class="title">UIAlertViewDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="MyViewController-m">MyViewController.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  MyViewController.m</span></span><br><span class="line"><span class="comment">//  Test</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-29.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"MyViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//没有xib，nib文件，不调用此方法，在loadView手写view生成</span></span><br><span class="line">- (<span class="keyword">id</span>)initWithNibName:(<span class="built_in">NSString</span> *)nibNameOrNil bundle:(<span class="built_in">NSBundle</span> *)nibBundleOrNil</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithNibName:nibNameOrNil bundle:nibBundleOrNil];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// Custom initialization</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)loadView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//只加载view，其他初始化放大viewDidLoad里面</span></span><br><span class="line">    <span class="built_in">UIView</span> *ui = [[<span class="built_in">UIView</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] applicationFrame]];</span><br><span class="line">    ui<span class="variable">.backgroundColor</span> = [<span class="built_in">UIColor</span> grayColor];</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.view</span> = ui;</span><br><span class="line">    [ui release];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIButton</span> *b = [[<span class="built_in">UIButton</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">200</span>)];</span><br><span class="line">    [b setTitle:<span class="string">@"按钮"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [b setTitleColor:[<span class="built_in">UIColor</span> blueColor] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [b addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnPress:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:b];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UITextView</span> *tv = [[<span class="built_in">UITextView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">50</span>,<span class="number">50</span>, <span class="number">50</span>)];</span><br><span class="line">    [tv setText:<span class="string">@"这是一个TV哦哦"</span>];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:tv];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UITextField</span> *tf = [[<span class="built_in">UITextField</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>)];</span><br><span class="line">    [tf setPlaceholder:<span class="string">@"请输入一个字符串，嘿嘿"</span>];</span><br><span class="line">    tf<span class="variable">.backgroundColor</span> = [<span class="built_in">UIColor</span> greenColor];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:tf];</span><br><span class="line">    </span><br><span class="line">    [b release];</span><br><span class="line">    [tv release];</span><br><span class="line">    [tf release];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> didReceiveMemoryWarning];</span><br><span class="line">    <span class="comment">// Dispose of any resources that can be recreated.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnPress:(<span class="keyword">id</span>)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *s;</span><br><span class="line">    s = [sender titleForState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIAlertView</span> *av = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:s message:<span class="string">@"你好啊"</span> delegate:<span class="keyword">self</span> cancelButtonTitle:<span class="string">@"取消"</span> otherButtonTitles:<span class="string">@"你好"</span>, <span class="literal">nil</span>];</span><br><span class="line">    [av show];</span><br><span class="line">    [sender setTitle:[av message] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)alertView:(<span class="built_in">UIAlertView</span> *)alertView clickedButtonAtIndex:(<span class="built_in">NSInteger</span>)buttonIndex</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (buttonIndex == <span class="number">1</span>) &#123;</span><br><span class="line">           <span class="built_in">UIAlertView</span> *av = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:<span class="string">@"xdfsofi"</span> message:<span class="string">@"摁2下了哦"</span> delegate:<span class="keyword">self</span> cancelButtonTitle:<span class="string">@"取消"</span> otherButtonTitles:<span class="literal">nil</span>, <span class="literal">nil</span>];</span><br><span class="line">        [av show];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">#pragma mark - Navigation</span><br><span class="line"></span><br><span class="line">// In a storyboard-based application, you will often want to do a little preparation before navigation</span><br><span class="line">- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    // Get the new view controller using [segue destinationViewController].</span><br><span class="line">    // Pass the selected object to the new view controller.</span><br><span class="line">&#125;</span><br><span class="line">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h2 id="demo2">demo2</h2><blockquote>
<p>代码创建,新建的空项目，有一个xib，viewController手动关联xib文件，和关联操作xib文件现有拖进去的控件，在xib文件上手写代码加入控件。xib文件名为xjlViewController.xib,其实应该大写的，一时糊涂，暂不改了  </p>
</blockquote>
<h3 id="main-m-1">main.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  main.m</span></span><br><span class="line"><span class="comment">//  ButtonFun</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-29.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 ___FULLUSERNAME___. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"xjlAppDelegate.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">UIApplicationMain</span>(argc, argv, <span class="literal">nil</span>, <span class="built_in">NSStringFromClass</span>([xjlAppDelegate class]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="xjlAppDelegate-h-1">xjlAppDelegate.h</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  xjlAppDelegate.h</span></span><br><span class="line"><span class="comment">//  ButtonFun</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-29.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 ___FULLUSERNAME___. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">xjlViewController</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">xjlAppDelegate</span> : <span class="title">UIResponder</span> &lt;<span class="title">UIApplicationDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIWindow</span> *window;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) xjlViewController *viewController;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="xjlAppDelegate-m-1">xjlAppDelegate.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"xjlAppDelegate.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"xjlViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">xjlAppDelegate</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.window</span> = [[<span class="built_in">UIWindow</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] bounds]];</span><br><span class="line">    <span class="comment">// Override point for customization after application launch.</span></span><br><span class="line">    <span class="keyword">self</span><span class="variable">.viewController</span> = [[xjlViewController alloc] initWithNibName:<span class="string">@"xjlViewController"</span> bundle:<span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.window</span><span class="variable">.rootViewController</span> = <span class="keyword">self</span><span class="variable">.viewController</span>;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.window</span><span class="variable">.backgroundColor</span> = [<span class="built_in">UIColor</span> whiteColor];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.window</span> makeKeyAndVisible];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="xjlViewController-h">xjlViewController.h</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  xjlViewController.h</span></span><br><span class="line"><span class="comment">//  ButtonFun</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-29.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">xjlViewController</span> : <span class="title">UIViewController</span> &lt;<span class="title">UIAlertViewDelegate</span>, <span class="title">UIActionSheetDelegate</span>&gt;</span></span><br><span class="line"><span class="comment">//关联xib外部按钮</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *btnOut;</span><br><span class="line"><span class="comment">//关联xib外部按钮的事件</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)btnOutPress:(<span class="keyword">id</span>)sender;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="xjlViewController-m">xjlViewController.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  xjlViewController.m</span></span><br><span class="line"><span class="comment">//  ButtonFun</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-29.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"xjlViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">xjlViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">xjlViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//如果需要在其他地方调用，和关联xib，调用次方法</span></span><br><span class="line">- (<span class="keyword">id</span>)initWithNibName:(<span class="built_in">NSString</span> *)nibNameOrNil bundle:(<span class="built_in">NSBundle</span> *)nibBundleOrNil</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithNibName:nibNameOrNil bundle:nibBundleOrNil];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// Custom initialization</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view from its nib.</span></span><br><span class="line">    <span class="built_in">UIButton</span> *button = [[<span class="built_in">UIButton</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">120</span>, <span class="number">120</span>, <span class="number">20</span>)];</span><br><span class="line">    [button setTitle:<span class="string">@"代码创建按钮"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    <span class="comment">//设置颜色，要不然看不见，和背景一样</span></span><br><span class="line">    [button setTitleColor:[<span class="built_in">UIColor</span> blueColor] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [button addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(buttonPress:message:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.view</span> addSubview:button];</span><br><span class="line">    [button release];</span><br><span class="line">    <span class="comment">//拖进去的控件</span></span><br><span class="line">    [[<span class="keyword">self</span> btnOut] setTitle:<span class="string">@"ib拖进去的按钮哦"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> didReceiveMemoryWarning];</span><br><span class="line">    <span class="comment">// Dispose of any resources that can be recreated.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)btnOutPress:(<span class="keyword">id</span>)sender &#123;</span><br><span class="line">    <span class="built_in">UIAlertView</span> *av = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:[sender titleForState:<span class="built_in">UIControlStateNormal</span>] message:[sender titleForState:<span class="built_in">UIControlStateNormal</span>] delegate:<span class="keyword">self</span> cancelButtonTitle:<span class="string">@"HI"</span> otherButtonTitles:<span class="literal">nil</span>, <span class="literal">nil</span>];</span><br><span class="line">    [av show];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)buttonPress:(<span class="keyword">id</span>)sender message:(<span class="built_in">NSString</span> *)msg</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIActionSheet</span> *as = [[<span class="built_in">UIActionSheet</span> alloc] initWithTitle:[sender titleForState:<span class="built_in">UIControlStateNormal</span>] delegate:<span class="keyword">self</span> cancelButtonTitle:<span class="string">@"9xisis的看法呢"</span> destructiveButtonTitle:<span class="string">@"fodjofjdosjof"</span> otherButtonTitles:<span class="string">@"哦isjdfosd"</span>, <span class="literal">nil</span>];</span><br><span class="line">    [as showInView:<span class="keyword">self</span><span class="variable">.view</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/18/objective-c-archiver.html">
                Objective-C归档
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-18
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="归档概念">归档概念</h2><p>对象归档是指将对象写入文件保存在硬盘上，当再次重新打开程序时间，可以还原这些对象。也可以称它为对象序列化，对象持久化  </p>
<p>数据持久性的方式:  </p>
<blockquote>
<p>1.NSKeyedArchiver—对象归档<br>2.NSUserDefaults<br>3.XML属性列表归档(NSArray,NSDictionary保存文件)<br>4.SQlite数据库，Core Data数据库  </p>
</blockquote>
<p>归档的形式</p>
<blockquote>
<p>1.对Foundation库中对象进行归档<br>2.自定义对象进行归档（需要实现归档协议，NSCodeing）<br>归档后的文件是加密的，属性列表是明文的</p>
</blockquote>
<h2 id="XML属性列表归档">XML属性列表归档</h2><p>只支持Foundation里的NSString,NSNumber,NSArray,NSDictionary,NSData进行归档</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用属性列表归档</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *glossary = [<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:</span><br><span class="line">                              <span class="string">@"A class defined so other classes can inherit form it"</span>,</span><br><span class="line">                              <span class="string">@"abstract class"</span>,</span><br><span class="line">                              <span class="string">@"To implement all methods defined in a protocol"</span>,</span><br><span class="line">                              <span class="string">@"adopt"</span>,</span><br><span class="line">                              <span class="string">@"Storing an object for later user."</span>,</span><br><span class="line">                              <span class="string">@"archiving"</span>, <span class="literal">nil</span>];</span><br><span class="line">[glossary writeToFile:<span class="string">@"/Users/lxj/glossary"</span> atomically:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([glossary writeToFile:<span class="string">@"glossary"</span> atomically:<span class="literal">YES</span>] == <span class="literal">NO</span>) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Save to file failed!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="NSKeyedArchive归档">NSKeyedArchive归档</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSDictionary</span> *glossary = [<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:</span><br><span class="line">                              <span class="string">@"A class defined so other classes can inherit form it"</span>,</span><br><span class="line">                              <span class="string">@"abstract class"</span>,</span><br><span class="line">                              <span class="string">@"To implement all methods defined in a protocol"</span>,</span><br><span class="line">                              <span class="string">@"adopt"</span>,</span><br><span class="line">                              <span class="string">@"Storing an object for later user."</span>,</span><br><span class="line">                              <span class="string">@"archiving"</span>, <span class="literal">nil</span>];</span><br><span class="line"><span class="comment">//归档                             </span></span><br><span class="line">[<span class="built_in">NSKeyedArchiver</span> archiveRootObject:glossary toFile:<span class="string">@"/Users/lxj/glossary.archive"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//解归档</span></span><br><span class="line">getGlossary = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithFile:<span class="string">@"/Users/lxj/glossary.archive"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSString</span> *key <span class="keyword">in</span> getGlossary) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@=%@"</span>, key, [getGlossary objectForKey:key]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>NSData自定义内容归档<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自定义内容归档（序列化）</span></span><br><span class="line"><span class="built_in">NSMutableData</span> *data = [<span class="built_in">NSMutableData</span> data];</span><br><span class="line"><span class="built_in">NSKeyedArchiver</span> *ka = [[<span class="built_in">NSKeyedArchiver</span> alloc] initForWritingWithMutableData:data];</span><br><span class="line"><span class="built_in">NSArray</span> *a = @[<span class="string">@"xjliao"</span>, <span class="string">@"jrliao"</span>, <span class="string">@"lhdeng"</span>, <span class="string">@"xyliao"</span>, <span class="string">@"lihualou"</span>];</span><br><span class="line">[ka encodeObject:a forKey:<span class="string">@"name"</span>];</span><br><span class="line">[ka encodeInt:<span class="number">25</span> forKey:<span class="string">@"age"</span>];</span><br><span class="line">[ka finishEncoding];</span><br><span class="line">[ka release];</span><br><span class="line">[data writeToFile:<span class="string">@"/Users/lxj/data.archive"</span> atomically:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//解归档(反序列化）</span></span><br><span class="line"><span class="built_in">NSData</span> *d = [<span class="built_in">NSData</span>  dataWithContentsOfFile:<span class="string">@"/Users/lxj/data.archive"</span>];</span><br><span class="line"><span class="built_in">NSKeyedUnarchiver</span> *kud = [[<span class="built_in">NSKeyedUnarchiver</span> alloc] initForReadingWithData:d];</span><br><span class="line"><span class="built_in">NSArray</span> *ua = [kud decodeObjectForKey:<span class="string">@"name"</span>];</span><br><span class="line"><span class="keyword">int</span> age = [kud decodeIntForKey:<span class="string">@"age"</span>];</span><br><span class="line">[kud release];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, ua);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%i"</span>, age);</span><br></pre></td></tr></table></figure></p>
<h2 id="自定义对象归档">自定义对象归档</h2><p>需要实现<nscoding>协议的下面两个方法  </nscoding></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对属性编码，归档时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)aCoder;</span><br><span class="line"><span class="comment">//对属性解码，解归档调用</span></span><br><span class="line">- (<span class="keyword">id</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder;</span><br></pre></td></tr></table></figure>
<p>Person.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Person.h</span></span><br><span class="line"><span class="comment">//  gd</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-18.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span> &lt;<span class="title">NSMutableCopying</span>, <span class="title">NSCoding</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name, *email;</span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>Person.m<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Person.m</span></span><br><span class="line"><span class="comment">//  gd</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-18.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#define NAME @<span class="title">"name"</span></span></span><br><span class="line"><span class="preprocessor">#define AGE @<span class="title">"age"</span></span></span><br><span class="line"><span class="preprocessor">#define EMAIL @<span class="title">"email"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)mutableCopyWithZone:(<span class="built_in">NSZone</span> *)zone</span><br><span class="line">&#123;</span><br><span class="line">    Person *person = [[[<span class="keyword">self</span> class] allocWithZone:zone] init];</span><br><span class="line">    [person setName:[_name mutableCopy]];</span><br><span class="line">    [person setAge:_age];</span><br><span class="line">    [person setEmail:[_email mutableCopy]];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//对属性编码，归档时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)aCoder</span><br><span class="line">&#123;</span><br><span class="line">    [aCoder encodeObject:[<span class="keyword">self</span> name] forKey:NAME];</span><br><span class="line">    [aCoder encodeInt:[<span class="keyword">self</span> age] forKey:AGE];</span><br><span class="line">    [aCoder encodeObject:[<span class="keyword">self</span> email] forKey:EMAIL];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//对属性解码，解归档调用</span></span><br><span class="line">- (<span class="keyword">id</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> != <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span><span class="variable">.name</span> = [aDecoder decodeObjectForKey:NAME];</span><br><span class="line">        _age = [aDecoder decodeIntForKey:AGE];</span><br><span class="line">        [<span class="keyword">self</span> setEmail:[aDecoder decodeObjectForKey:EMAIL]];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)description</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *nstr = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"名字：%@ 年龄:%i 邮箱：%@"</span>,</span><br><span class="line">                      [<span class="keyword">self</span> name], [<span class="keyword">self</span> age], [<span class="keyword">self</span> email]];</span><br><span class="line">    <span class="keyword">return</span> nstr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>测试main.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  main.m</span></span><br><span class="line"><span class="comment">//  gd</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-18.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;        </span><br><span class="line">        <span class="comment">//自定义对象归档Person实现NSCoding</span></span><br><span class="line">        <span class="comment">//归档</span></span><br><span class="line">        Person *p = [[Person alloc] init];</span><br><span class="line">        [p setName:<span class="string">@"liaoxinjian"</span>];</span><br><span class="line">        [p setAge:<span class="number">25</span>];</span><br><span class="line">        [p setEmail:<span class="string">@"lxj990@gmail.com"</span>];</span><br><span class="line">        </span><br><span class="line">        [<span class="built_in">NSKeyedArchiver</span> archiveRootObject:p toFile:<span class="string">@"/Users/lxj/person.arc"</span>];</span><br><span class="line">        </span><br><span class="line">        [p release];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//解归档</span></span><br><span class="line">        Person *p1;</span><br><span class="line">        p1 = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithFile:<span class="string">@"/Users/lxj/person.arc"</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1 = %@"</span>, p1);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1.name=%@, age=%i, email=%@"</span>, [p1 name], [p1 age], [p1 email]);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>//NSData自定义内容归档<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自定义内容归档</span></span><br><span class="line">Person *p3 = [[Person alloc] init];</span><br><span class="line">[p3 setName:<span class="string">@"liaoxinjian"</span>];</span><br><span class="line">[p3 setAge:<span class="number">25</span>];</span><br><span class="line">[p3 setEmail:<span class="string">@"lxj990@gmail.com"</span>];</span><br><span class="line"></span><br><span class="line">Person *p4 = [[Person alloc] init];</span><br><span class="line">[p4 setName:<span class="string">@"loulihua"</span>];</span><br><span class="line">[p4 setAge:<span class="number">23</span>];</span><br><span class="line">[p4 setEmail:<span class="string">@"suplss@163.com"</span>];</span><br><span class="line"></span><br><span class="line">Person *p5 = [[Person alloc] init];</span><br><span class="line">[p5 setName:<span class="string">@"denglianhong"</span>];</span><br><span class="line">[p5 setAge:<span class="number">25</span>];</span><br><span class="line">[p5 setEmail:<span class="string">@"denglianhong@163.com"</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSMutableData</span> *pd = [<span class="built_in">NSMutableData</span> data];</span><br><span class="line"><span class="built_in">NSKeyedArchiver</span> *pka = [[<span class="built_in">NSKeyedArchiver</span> alloc] initForWritingWithMutableData:pd];</span><br><span class="line">[pka encodeObject:p3 forKey:<span class="string">@"p3"</span>];</span><br><span class="line">[pka encodeObject:p4 forKey:<span class="string">@"p4"</span>];</span><br><span class="line">[pka encodeObject:p5 forKey:<span class="string">@"p5"</span>];</span><br><span class="line">[pka finishEncoding];</span><br><span class="line">[pka release];</span><br><span class="line"></span><br><span class="line">[pd writeToFile:<span class="string">@"/Users/lxj/personData.arc"</span> atomically:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义内容解档</span></span><br><span class="line"><span class="built_in">NSData</span> *dp = [<span class="built_in">NSData</span> dataWithContentsOfFile:<span class="string">@"/Users/lxj/personData.arc"</span>];</span><br><span class="line"><span class="built_in">NSKeyedUnarchiver</span> *pku = [[<span class="built_in">NSKeyedUnarchiver</span> alloc] initForReadingWithData:dp];</span><br><span class="line">Person *p33 = [pku decodeObjectForKey:<span class="string">@"p3"</span>];</span><br><span class="line">Person *p44 = [pku decodeObjectForKey:<span class="string">@"p4"</span>];</span><br><span class="line">Person *p55 = [pku decodeObjectForKey:<span class="string">@"p5"</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"p33.name=%@ age=%i email=%@"</span>, [p33 name],[p33 age], [p33 email]);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"p44.name=%@ age=%i email=%@"</span>, [p44 name], [p44 age], [p44 email]);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"p55.name=%@ age=%i email=%@"</span>, [p55 name], [p55 age], [p55 email]);</span><br></pre></td></tr></table></figure></p>
<h2 id="归档总结">归档总结</h2><ul>
<li>归档和解归档的两种方式<br>1.简单的把一个对象归档为一个文件<br>2.把数据编码到NSData文件中，然后归档到文件中</li>
<li>自定义对象如何归档，实现NSCoding协议</li>
<li>归档后的文件是加密的</li>
</ul>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/15/objective-c-copy_object.html">
                Objective-C复制对象
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-15
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="复制对象">复制对象</h2><p>对象的复制就是复制一个对象作为副本，他会开辟一块新的内存（堆内存）来存储副本对象，就像复制文件一样，即源对象和副本对象是两块不同的内存区域。对象要具备复制功能，必须实现<nscopying>协议或者<nsmutablecopying>协议，常用的可复制对象有：NSNumber、NSString、NSMutableString、NSArray、NSMutableArray、NSDictionary、NSMutableDictionary</nsmutablecopying></nscopying></p>
<h2 id="copy和mutableCopy方法">copy和mutableCopy方法</h2><blockquote>
<p>1.copy返回的是一个不可变的对象副本<br>2.mutableCopy返回的是一个可变对象副本,无论源对象是否可变，返回的对象副本是可变的.</p>
</blockquote>
<p>Foundation类实现了名为copy何mutableCopy的方法,可以使用这些方法创建对象的副本.通过实现一个符合<nscopying>协议(用于制作副本)的方法来完成此任务.如果类必须要区分要产生对象时可变副本还是不可变副本,还需要根据<nsmutablecopying>协议实现一个方法。</nsmutablecopying></nscopying></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dataArray2 = [dataArray mutableCopy];</span><br><span class="line">[dataArray2 removeObjectAtIndex:<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>上面的这段代码,在内存中创建了一个新得dataArray副本,并复制了它的所有的元素,随后执行语句</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[dataArray2 removeObjectAtIndex:<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<p>删除了dataArray2中的第一个元素,但却不删除dataArray中的第一个元素,简单复制都会删除.</p>
<p>demo1<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  main.m</span></span><br><span class="line"><span class="comment">//  co</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-16.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// insert code here...</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"简单复制"</span>);</span><br><span class="line">        <span class="built_in">NSMutableArray</span> *dataArray = [<span class="built_in">NSMutableArray</span> arrayWithObjects:</span><br><span class="line">               <span class="string">@"one"</span>, <span class="string">@"tow"</span>, <span class="string">@"three"</span>, <span class="string">@"four"</span>, <span class="literal">nil</span>];</span><br><span class="line">        <span class="built_in">NSMutableArray</span> *dataArray2;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//简单复制</span></span><br><span class="line">        dataArray2 = dataArray;</span><br><span class="line">        [dataArray2 removeObjectAtIndex:<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"dataArray:"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">NSString</span> *elem <span class="keyword">in</span> dataArray) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"  %@"</span>, elem);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"dataArray2:"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">NSString</span> *elem <span class="keyword">in</span> dataArray2) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"  %@"</span>, elem);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//复制一份,然后删除副本的第一个元素</span></span><br><span class="line">        dataArray2 = [dataArray mutableCopy];</span><br><span class="line">        [dataArray2 removeObjectAtIndex:<span class="number">0</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"dataArray:"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">NSString</span> *elem <span class="keyword">in</span> dataArray) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"  %@"</span>, elem);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"dataArray2:"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">NSString</span> *elem <span class="keyword">in</span> dataArray2) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"  %@"</span>, elem);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>结果<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.405</span> co[<span class="number">714</span>:<span class="number">303</span>] 简单复制</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.406</span> co[<span class="number">714</span>:<span class="number">303</span>] dataArray:</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.407</span> co[<span class="number">714</span>:<span class="number">303</span>]   tow</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.407</span> co[<span class="number">714</span>:<span class="number">303</span>]   three</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.407</span> co[<span class="number">714</span>:<span class="number">303</span>]   four</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.408</span> co[<span class="number">714</span>:<span class="number">303</span>] dataArray2:</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.408</span> co[<span class="number">714</span>:<span class="number">303</span>]   tow</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.408</span> co[<span class="number">714</span>:<span class="number">303</span>]   three</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.409</span> co[<span class="number">714</span>:<span class="number">303</span>]   four</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.409</span> co[<span class="number">714</span>:<span class="number">303</span>] dataArray:</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.410</span> co[<span class="number">714</span>:<span class="number">303</span>]   tow</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.410</span> co[<span class="number">714</span>:<span class="number">303</span>]   three</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.410</span> co[<span class="number">714</span>:<span class="number">303</span>]   four</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.411</span> co[<span class="number">714</span>:<span class="number">303</span>] dataArray2:</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.411</span> co[<span class="number">714</span>:<span class="number">303</span>]   three</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">16</span> <span class="number">23</span>:<span class="number">21</span>:<span class="number">33.411</span> co[<span class="number">714</span>:<span class="number">303</span>]   four</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>demo1这个程序定义了可变数组dataArray,并分别将其元素设置为字符串对象@”one”,@”two”, @”three”和@”four”.复制语句dataArray2 = dataArray;仅仅创建了对内存中同一书中对象的一个引用.这两个引用中的第一个元素都会被删除.<br>然后创建一个dataArray的可变副本并赋值给dataArray2的最终副本.这就在内存中创建了两个截然相同的可变数组.所以任意操作它们其中的一个都不会相互影响.</p>
</blockquote>
<h2 id="浅复制与深复制">浅复制与深复制</h2><p>Objective-C对象的深，浅拷贝的区别就在于对copyWithZone或者mutableCopyWithZone的不同实现  </p>
<p>浅复制：对象的属性直接复制<br>深复制：使用属性的copy</p>
<blockquote>
<p>1.浅复制只复制对象的本身,对象里的属性,包含的对象不做复制.对象里的属性和对象指向的还是用同一块内存地址.<br>2.深复制则即复制对象本身,对象的属性也会复制一份(即和源对象的属性地址不是同一块)<br>3.Foundation框架支持复制的类,默认都是浅复制.如果需要为深复制,则需要使用分类(category)添加</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableArray</span> *dataArray3 = [<span class="built_in">NSMutableArray</span> arrayWithObjects:</span><br><span class="line">    [<span class="built_in">NSMutableString</span> stringWithString:<span class="string">@"one"</span>],</span><br><span class="line">    [<span class="built_in">NSMutableString</span> stringWithString:<span class="string">@"two"</span>],</span><br><span class="line">    [<span class="built_in">NSMutableString</span> stringWithString:<span class="string">@"three"</span>], <span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSMutableArray</span> *dataArray4;</span><br><span class="line"><span class="built_in">NSMutableString</span> *mStr;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"浅拷贝与深拷贝"</span>);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"dataArray3:"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSString</span> *elem <span class="keyword">in</span> dataArray3) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"  %@"</span>, elem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//复制一份,然后删除副本的第一个元素</span></span><br><span class="line">dataArray4 = [dataArray3 mutableCopy];</span><br><span class="line">mStr = [dataArray3 objectAtIndex:<span class="number">0</span>];</span><br><span class="line">[mStr appendString:<span class="string">@"ONE"</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"dataArray3:"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSString</span> *elem <span class="keyword">in</span> dataArray3) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"  %@"</span>, elem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"dataArray4:"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">NSString</span> *elem <span class="keyword">in</span> dataArray4) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@" %@"</span>, elem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2014-05-16 23:21:33.412 co[714:303] &#27973;&#25335;&#36125;&#19982;&#28145;&#25335;&#36125;&#10;2014-05-16 23:21:33.412 co[714:303] dataArray3:&#10;2014-05-16 23:21:33.412 co[714:303]   one&#10;2014-05-16 23:21:33.413 co[714:303]   two&#10;2014-05-16 23:21:33.413 co[714:303]   three&#10;2014-05-16 23:21:33.414 co[714:303] dataArray3:&#10;2014-05-16 23:21:33.414 co[714:303]   oneONE&#10;2014-05-16 23:21:33.414 co[714:303]   two&#10;2014-05-16 23:21:33.415 co[714:303]   three&#10;2014-05-16 23:21:33.415 co[714:303] dataArray4:&#10;2014-05-16 23:21:33.415 co[714:303]  oneONE&#10;2014-05-16 23:21:33.416 co[714:303]  two&#10;2014-05-16 23:21:33.416 co[714:303]  three&#10;Program ended with exit code: 0</span><br></pre></td></tr></table></figure>
<h2 id="深浅复制和retain之间的总结">深浅复制和retain之间的总结</h2><p>copy、mutableCopy和retain之间的关系<br>1.Foundation可复制的对象，当我们copy的时一个不可变的对象时，它的作用相当于retain(cocoa做得内存优化)<br>2.当我们使用mutableCopy时，无论源对象是否可变，副本是可变的，并且实现了真正意义上的拷贝<br>3.当我们copy的是一个可变对象时，副本对象时不可变得，同样实现了真正意义上的拷贝</p>
<h2 id="对象自定义复制">对象自定义复制</h2><blockquote>
<p>对象的拥有复制特性,须实现NSCopying、NSMutableCopying协议，实现该协议的copyWithZone:方法（NSCopying协议的）和mutableCopyWithZone:方法（NSMutableCoping协议的)  </p>
</blockquote>
<p>demo<br>不可变  </p>
<p>Person.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span> &lt;<span class="title">NSCopying</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, retain) <span class="built_in">NSNumber</span> *age;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>Person.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"Person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//@synthesize name = _name, age = _age; //新版本xcode 无需再写了</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//    //浅复制</span></span><br><span class="line"><span class="comment">//    Person *person = [[Person allocWithZone:zone] init];</span></span><br><span class="line"><span class="comment">//    person.name = _name;</span></span><br><span class="line"><span class="comment">//    person.age = _age;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//深复制</span></span><br><span class="line">    Person *person = [[Person allocWithZone:zone] init];</span><br><span class="line">    [person setName:[_name mutableCopy]];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//NSNumber是不可变的，所以只能用copy或者=</span></span><br><span class="line">    [person setAge:[_age <span class="keyword">copy</span>]];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>可变对象</p>
<p>Person1.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person1</span> : <span class="title">NSObject</span> &lt;<span class="title">NSMutableCopying</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"Person1.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person1</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)mutableCopyWithZone:(<span class="built_in">NSZone</span> *)zone</span><br><span class="line">&#123;</span><br><span class="line">    Person1 *p = [[Person1 allocWithZone:zone] init];</span><br><span class="line">    <span class="comment">//浅拷贝</span></span><br><span class="line">    <span class="comment">//p.name = _name;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//深拷贝</span></span><br><span class="line">    p<span class="variable">.name</span> = [_name mutableCopy];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>测试</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  main.m</span></span><br><span class="line"><span class="comment">//  cucp</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-18.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Person.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Person1.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// insert code here...</span></span><br><span class="line">        <span class="comment">//不可变复制</span></span><br><span class="line">        Person *p1 = [[Person alloc] init];</span><br><span class="line">        Person *p2;</span><br><span class="line">        </span><br><span class="line">        [p1 setName:<span class="string">@"廖新建"</span>];</span><br><span class="line">        [p1 setAge:[<span class="built_in">NSNumber</span> numberWithInt:<span class="number">25</span>]];</span><br><span class="line">        </span><br><span class="line">        p2 = [p1 <span class="keyword">copy</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1.p %p"</span>, p1);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p2.p %p"</span>, p2);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1.name %p"</span>, [p1 name]);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p2.name %p"</span>, [p2 name]);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1.age %p"</span>, [p1 age]);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p2.age %p"</span>, [p2 age]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//可变复制</span></span><br><span class="line">        Person1 *p3 = [[Person1 alloc] init];</span><br><span class="line">        p3<span class="variable">.name</span> = <span class="string">@"廖家儒"</span>;</span><br><span class="line">        </span><br><span class="line">        Person1 *p4 = [p3 mutableCopy];</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p3.p %p  p4.p %p"</span>, p3, p4);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p3.name %p  p4.name %p"</span>, p3<span class="variable">.name</span>, p4<span class="variable">.name</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">53</span>:<span class="number">04.145</span> cucp[<span class="number">1333</span>:<span class="number">303</span>] p1<span class="variable">.p</span> <span class="number">0x100202830</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">53</span>:<span class="number">04.147</span> cucp[<span class="number">1333</span>:<span class="number">303</span>] p2<span class="variable">.p</span> <span class="number">0x1002028d0</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">53</span>:<span class="number">04.147</span> cucp[<span class="number">1333</span>:<span class="number">303</span>] p1<span class="variable">.name</span> <span class="number">0x100002598</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">53</span>:<span class="number">04.148</span> cucp[<span class="number">1333</span>:<span class="number">303</span>] p2<span class="variable">.name</span> <span class="number">0x100202a10</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">53</span>:<span class="number">04.148</span> cucp[<span class="number">1333</span>:<span class="number">303</span>] p1<span class="variable">.age</span> <span class="number">0x1927</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">53</span>:<span class="number">04.149</span> cucp[<span class="number">1333</span>:<span class="number">303</span>] p2<span class="variable">.age</span> <span class="number">0x1927</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">53</span>:<span class="number">04.149</span> cucp[<span class="number">1333</span>:<span class="number">303</span>] p3<span class="variable">.p</span> <span class="number">0x1002046f0</span>  p4<span class="variable">.p</span> <span class="number">0x100204700</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">53</span>:<span class="number">04.149</span> cucp[<span class="number">1333</span>:<span class="number">303</span>] p3<span class="variable">.name</span> <span class="number">0x100002678</span>  p4<span class="variable">.name</span> <span class="number">0x100203580</span></span><br><span class="line">Program ended with exit code: <span class="number">0</span></span><br></pre></td></tr></table></figure>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/14/objective-c-memory-manager.html">
                Objective-C内存管理
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-14
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="先看两句代码">先看两句代码</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *myData = [<span class="built_in">NSArray</span> arrayWithContentsOfFile:<span class="string">@"Person.h"</span>];</span><br><span class="line">myData = [<span class="built_in">NSArray</span> arrayWithContentsOfFile:<span class="string">@"Person.m"</span>];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第1行代码：一个变量myData,从一个文件中得内容读入数组中，内容数组得引用村存储在变量myData中。<br>第2行代码：读取另外一个文件，这时myData已经变了，引用到另一个数组了。内容来自第二歌文件中。<br>那么第一个数组如何处理？已经不再引用这个数组（当覆盖myData后，数组不再被引用）。第一个数组元素会怎么样？假如你需要重复从成百上千份文件中读取数据，这些数组和他们得元素不会被引用，并且引用不再需要这些数据，如何处理这种情况</p>
</blockquote>
<h2 id="内存管理三种模型：">内存管理三种模型：</h2><blockquote>
<p>1.自动垃圾收集<br>2.手工引用计数和自动释放池<br>3.自动引用计数（ARC)  </p>
</blockquote>
<p>1、自动垃圾收集<br>此方法只能用在Mac OS X程序开发上,不多介绍  </p>
<p>2、手工管理内存计数<br>当创建对象时，初始得引用计数为1。为保证对象得存在，每当创建引用到对象需要为引用数加1，可以给对象发送retain消息：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[myObject retain];</span><br></pre></td></tr></table></figure><br>当不再需要对象时，通过对象发送release消息，为引用计数减1。<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[myObject retain];</span><br></pre></td></tr></table></figure><br>当对象得引用计数为0时，系统知道这个对象不再需要使用，所以就可以释放它得内存。通过给对象发送deallo消息发起这个过程。在多数情况下，会使用继承自NSObject得dealloc方法。然而,为了能够释放由对象创建或保持得实例变量或者其他对象，需要覆盖dealloc方法。例如，在你得类中，有一个实例变量为NSArray得对象，并且为他创建了一个数组，当对象销毁时，你需要负责释放数组，在dealloc方法中可以做这些事情。</p>
<h2 id="一个小例子">一个小例子</h2><p>Person.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Person.h</span></span><br><span class="line"><span class="comment">//  m</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-13.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">Dog</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *_name, *_age, *_sex;</span><br><span class="line">    Dog *_dog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSString</span> *name, *age, *sex;</span><br><span class="line">- (<span class="keyword">void</span>)printInfo;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setDog:(Dog *)newDog;</span><br><span class="line">- (Dog *)dog;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>Person.m<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Person.m</span></span><br><span class="line"><span class="comment">//  m</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-13.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@synthesize</span> name = _name, age = _age, sex = _sex;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)printInfo</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"姓名：%@, 年龄：%@, 性别：%@"</span>, [<span class="keyword">self</span> name], [<span class="keyword">self</span> age], [<span class="keyword">self</span> sex]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"the person %@ died"</span>, [<span class="keyword">self</span> name]);</span><br><span class="line">    [[<span class="keyword">self</span> dog] release];</span><br><span class="line">    [<span class="keyword">super</span> dealloc];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (Dog *)dog</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _dog;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setDog:(Dog *)newDog</span><br><span class="line">&#123;</span><br><span class="line">    _dog = [newDog retain];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>Dog.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Dog.h</span></span><br><span class="line"><span class="comment">//  m</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-14.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Dog</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> _<span class="keyword">id</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *_name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">int</span> <span class="keyword">id</span>;</span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSString</span> *name;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)printInfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>Dog.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Dog.m</span></span><br><span class="line"><span class="comment">//  m</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-14.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Dog.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Dog</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@synthesize</span> <span class="keyword">id</span> = _<span class="keyword">id</span>, name = _name;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)printInfo</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"This dog id = %i, name = %@"</span>, [<span class="keyword">self</span> <span class="keyword">id</span>], [<span class="keyword">self</span> name]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"the dog %@ is died!"</span>, [<span class="keyword">self</span> name]);</span><br><span class="line">    [<span class="keyword">super</span> dealloc];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>测试<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  main.m</span></span><br><span class="line"><span class="comment">//  m</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-13.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Person.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Dog.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// insert code here...</span></span><br><span class="line">    <span class="comment">//这句代码可以这样写</span></span><br><span class="line">    <span class="comment">/*@autoreleasepool &#123;</span><br><span class="line">        代码放这里</span><br><span class="line">    &#125;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="built_in">NSAutoreleasePool</span> *ap = [[<span class="built_in">NSAutoreleasePool</span> alloc] init];</span><br><span class="line">    </span><br><span class="line">    Person *p1 = [[Person alloc] init];</span><br><span class="line">    Dog *d1 = [[Dog alloc] init];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"p1 retain = %lu"</span>, [p1 retainCount]);</span><br><span class="line">   </span><br><span class="line">    [p1 setName:<span class="string">@"p1"</span>];</span><br><span class="line">    [p1 setAge:<span class="string">@"25"</span>];</span><br><span class="line">    [d1 setId:<span class="number">1</span>];</span><br><span class="line">    [d1 setName:<span class="string">@"d1"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//NSLog(@"d1 retain:%lu", [d1 retainCount]);</span></span><br><span class="line">    </span><br><span class="line">    [d1 printInfo];</span><br><span class="line">    [p1 setDog:d1];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"d1 retain:%lu"</span>, [d1 retainCount]);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"p1 retain:%lu"</span>, [p1 retainCount]);</span><br><span class="line">    <span class="comment">//[p1 release];</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"d1 retain:%lu"</span>, [d1 retainCount]);</span><br><span class="line">    </span><br><span class="line">    [d1 release];</span><br><span class="line">    [p1 autorelease];</span><br><span class="line">    </span><br><span class="line">    [ap drain];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3、对象引用和自动释放池</p>
<blockquote>
<p>你可能会编写这样一个方法，先创建一个对象（使用alloc）。然后将它作为方法调用得结果返回。  </p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (Dog *)dog</span><br><span class="line">&#123;</span><br><span class="line">    Dog *dog = [[Dog alloc] init];</span><br><span class="line">    [dog setId:<span class="number">1</span>];</span><br><span class="line">    [dog setName:<span class="string">@"d1"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> dog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就进入一个困境：尽管方法不再使用这个对象，但时并不能释放它，因为需要将这个对象作为方法得返回值。NSAutoreleasePool类创建得目的就是希望解决这个问题，自动释放池可以帮助追踪需要延迟一些时间释放得对象。通过给自动释放池发送drain消息，自动释放池就会被清理，对象也会被释放。<br>给对象发送autorelease消息，将一个对象添加得自动释放池维护得对象列表中［result autorelease］。<br>在程序中使用来自Foundation、UIKit、AppKit框架得类时，需要先创建一个自动释放池，因为来自这些框架得类会创建并返回自动释放的对象，需要在应用中这样写:<br>NSAutoreleasePool *ap = [[NSAutoreleasePool alloc] init];   </p>
<p>自动释放池建立后，框架方法会自动添加对象（如数组、字符串、词典、视图、按钮和其他对象）到自动释放池维护列表中。<br>使用完自动释放池，需要给它发送drain消息:<br>[ap drain];<br>这将影响到所有发送过autorelease消息并添加到自动食饭吃好中的对象，会对对象池中的每个对象发送release消息，当这些对象的引用计数减至0时，会发送出dealloc消息，并且他们的内存会被释放。<br>需要注意的时，自动释放池并不包含实际的对象，而是只包含对象的引用，对象将在自动释放池清理的时候被释放。  </p>
<blockquote>
<p>并不是所有新创建的对象都会被添加到自动释放池中。任何由alloc、copy、mutableCopy和new为前缀的方法创建的对象都不会被自动释放。在这种情况下，可以说你拥有这个对象。当你拥有一个对象时，需要在使用完这些对象后负责释放这些对象的内存。主动给这些对象发送release消息，或者给对象发送autorelease消息将对象加入到自动释放池中。</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (Dog *)setDog</span><br><span class="line">&#123;</span><br><span class="line">    Dog *dog = [[Dog alloc] init];</span><br><span class="line">    [dog setId:<span class="number">111</span>];</span><br><span class="line">    [dog setName:<span class="string">@"dddd1"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> dog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>上面这个方法如果手动管理,这个方法会出现一个问题，创建的对象会在计算执行后，被方法作为结果返回。因为方法返回这个对象，所以并不能释放它，解决这个问题的最好方法是自动释放这个对象，这样它的值就能够作为结果返回，能够延迟对象的释放直到自动释放池被清理。如下：</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (Dog *)setDog</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//注释的代码与现在的方法二选一</span></span><br><span class="line">  <span class="comment">//Dog *dog = [[[Dog alloc] init] autorelease];</span></span><br><span class="line">    Dog *dog = [[Dog alloc] init];</span><br><span class="line">    [dog setId:<span class="number">111</span>];</span><br><span class="line">    [dog setName:<span class="string">@"dddd1"</span>];</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//return dog;</span></span><br><span class="line">    <span class="keyword">return</span> [dog autorelease];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="手动内存管理规则和总结">手动内存管理规则和总结</h2><blockquote>
<p>1、如果需要保持一个对象不被销毁，可以使用retain。在使用完对象后需要使用release进行释放。<br>2、给对象发送release消息并不会必须销毁这个对象，只当这个对象的引用计数减至0时，对象才被销毁。然后系统会发送dealloc消息给对象用于释放它的内存。<br>3、对使用了retain或者copy、mutableCopy、alloc或new方法的任何对象，以及具有retain和copy特性的属性进行释放，需要覆盖dealloc方法，使得在对象被释放的时候能够释放这些实例变量。<br>4、在自动释放池被清空时也会发送为自动释放的对象做些事情。系统每次都会在自动释放池被释放时发送release消息给池中的每个对象。如果池中的对象引用计数为0，系统会发送dealloc消息销毁对象。<br>5、如果在方法中不再需要用到这个对象，但需要将其返回，可以给这个对象发送autorelease消息用以标记这个对象延迟释放。autorelease消息并不会影响到对象的引用计数。<br>6、当应用终止时，内存中的所有对象都会被释放，不论他们是否在自动释放池中。<br>7、当开发Cocoa或者ios应用程序时，随着应用程序的运行，自动释放池会被创建和清空（每次的事件都会发生）。在这种情况下，如果要使用自动释放池被清空后自动释放的对象还能够存在，对象需要使用retain方法，只要这些对象的引用计数大于发送autorelease消息的数量，就能够在池清理后生存下来。</p>
</blockquote>
<h2 id="强变量：">强变量：</h2><p>当给变量赋值的时候，新的retain，旧的release，然后把新的assign给旧的，如果使用ARC，需要使用__strong关键字，<br>或者为属性添加strong特性，默认是unsafe_unretained(assign)<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__<span class="keyword">strong</span> Person *p2 = [[Person alloc] init];</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) Person *person;</span><br></pre></td></tr></table></figure></p>
<h2 id="弱变量：">弱变量：</h2><p>当两个对象都持有彼此的强引用时，将会产生循环保持(retain cycle)，解决这个问题可以弱引用，需要使用__weak<br>关键字，或者为属性添加weak特性，需要注意的是，iOS4和Mac10.6中不支持弱变量<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__<span class="keyword">weak</span> Person *p2 = [[Person alloc] init];</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) Person *person;</span><br></pre></td></tr></table></figure></p>
<h2 id="@autoreleasepool块">@autoreleasepool块</h2><p>在main中，有一个大块，会在应用程序结束的时候进行清理，如果在局部创建，可以再内部进行块的嵌套<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">10</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">            Person *p3 = [[Person alloc] init];</span><br><span class="line">            [p3 setName:<span class="string">@"sss"</span>];</span><br><span class="line">            [p3 setAge:<span class="number">13</span>];</span><br><span class="line">            [p3 setSex:<span class="string">@"w"</span>];</span><br><span class="line">            [p3 printInfo];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="@autoreleasepool块-1">@autoreleasepool块</h2>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/14/macos-eclipse.html">
                macos eclipse 提示：如果打开“Eclipse.app”，您需要Java SE 6 runtime。您想现在安装一个吗？
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-14
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Java/">Java</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>eclipse 默认使用jdk 6，但macos 10.9已经不自带jdk6了  </p>
<p>解决方案：  </p>
<h2 id="使用自定义jdk">使用自定义jdk</h2><p>安装好jdk后，修改文件。我这里使用得是jdk1.7.0_55</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xjliao:xjliao.me lxj$ sudo vim /Library/Java/JavaVirtualMachines/jdk1.<span class="number">7.0</span>_55.jdk/Contents/Info.plist</span><br></pre></td></tr></table></figure>
<p>修改或添加如下内容</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">key</span>&gt;</span>JVMCapabilities<span class="tag">&lt;/<span class="title">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">array</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">string</span>&gt;</span>JNI<span class="tag">&lt;/<span class="title">string</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">string</span>&gt;</span>BundledApp<span class="tag">&lt;/<span class="title">string</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">string</span>&gt;</span>WebStart<span class="tag">&lt;/<span class="title">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">string</span>&gt;</span>Applets<span class="tag">&lt;/<span class="title">string</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">string</span>&gt;</span>CommandLine<span class="tag">&lt;/<span class="title">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">array</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="按照提示去下载jdk6">按照提示去下载jdk6</h2><p><a href="http://support.apple.com/kb/DL1572?viewlocale=en_US" target="_blank" rel="external">下载：http://support.apple.com/kb/DL1572?viewlocale=en_US</a><br>安装后启动即可</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/09/c-point.html">
                C 指针
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-09
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/C/">C</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="一、C指针概念">一、C指针概念</h2><p>摘自：网易广州社区C语言版的精华区，对文章的有些地方做了调整。作者girlrong(阿蓉)，估计是个妹纸。可惜没找到原帖  </p>
<p>如果不懂这个东西，别说会C。</p>
<blockquote>
<p>指针是一个特殊的变量，它里面存储的数值被解释成为内存里的一个地址.</p>
</blockquote>
<p>要搞清一个指针需要搞清指针的四方面内容：</p>
<blockquote>
<p>1.指针的类型<br>2.指针所执行的类型<br>3.指针的值或者叫指针所指向的内存区<br>4.指针本身所占据的内存区</p>
</blockquote>
<p>Demo 1<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *ptr;</span><br><span class="line"><span class="keyword">char</span> *ptr;</span><br><span class="line"><span class="keyword">int</span> **ptr;</span><br><span class="line"><span class="keyword">int</span> (*ptr)[<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> *(*ptr)[<span class="number">4</span>];</span><br></pre></td></tr></table></figure></p>
<h3 id="指针的类型">指针的类型</h3><p>从语法的角度看，只要把指针与距离的指针名字去掉，剩下的部分就是指针的类型。这是指针本身所具有的类型。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *ptr;<span class="comment">//指针的类型是 int *</span></span><br><span class="line"><span class="keyword">char</span> *ptr;<span class="comment">//指针的类型是 char *</span></span><br><span class="line"><span class="keyword">int</span> **ptr;<span class="comment">//指针的类型是 int **</span></span><br><span class="line"><span class="keyword">int</span> (*ptr)[<span class="number">3</span>];<span class="comment">//指针的类型是 int (*)[3]</span></span><br><span class="line"><span class="keyword">int</span> *(*ptr)[<span class="number">4</span>];<span class="comment">//指针的类型是 int *(*)[4]</span></span><br></pre></td></tr></table></figure>
<p>判断指针的类型很简单吧！</p>
<h3 id="指针所指向的类型">指针所指向的类型</h3><p>当你通过指针来访问指针所指向的内存区时，指针所指向的类型决定了编译器把那片内存区的内容当作什么来看待。从语法上看，你只需把指针声明语句中的名字和左边的指针声明符*去掉，剩下的就是指针所指向的类型。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *ptr;<span class="comment">//指针所指向的类型是 int</span></span><br><span class="line"><span class="keyword">char</span> *ptr;<span class="comment">//指针所指向的类型是 char</span></span><br><span class="line"><span class="keyword">int</span> **ptr;<span class="comment">//指针所指向的类型是 int *</span></span><br><span class="line"><span class="keyword">int</span> (*ptr)[<span class="number">3</span>];<span class="comment">//指针所指向的类型是 int()[3]</span></span><br><span class="line"><span class="keyword">int</span> *(*ptr)[<span class="number">4</span>];<span class="comment">//指针所指向的类型是 int *()[4]</span></span><br></pre></td></tr></table></figure>
<p>在指针的算术运算符中，指针所指向的类型有很大的作用。  </p>
<p>指针的类型（即指针本身的类型）和指针所指向的类型是两个概念。当对C越来越熟悉时，会发现，把与指针搅合在一起的“类型”这个概念分成“指针的类型”和“指针所指向的类型”两个概念，即精通指针的关键点之一。  </p>
<h3 id="指针的值，或者叫指针的所指向的内存区或地址。">指针的值，或者叫指针的所指向的内存区或地址。</h3><p>指针的值时指指针本身存储的数字，这个指被编译器当作一个地址，而不是一个一般的数值。在32位程序里，所有类型的指针的值都是一个32位整数，因为32位程序里内存地址全都是32位长。</p>
<p>指针所指向的内存区就是从指针的值所代表的那个内存地址开始，长度为sizeof(指针所指向都类型))的一片内存区。以后，我们说一个指针的值时XX，就相当于说该指针指向了以XX为首地址的一片内存区域，我们说一个指针指向了某块内存区域，就相当于说该指针的值是这块内存区域的首地址。 </p>
<p>指针所指向的内存区和指针所指向的类型是两个完全不同的概念。在Demo 1中，指针所指向的类型已经又了，但由于还未初始化，所以所指向的内存区是不存在的，或者说是无意义的。</p>
<p>以后，没遇到一个指针，都应该问问：这个指针的类型是什么？指针指向的类型是什么？该指针指向了哪里？</p>
<h3 id="指针本身所占的内存区">指针本身所占的内存区</h3><p>指针本身占了多大的内存？你只要用函数sizeof(指针的类型)测以下就知道了。在32位平台李，指针本身占据4个字节的长度，指针本身占据的内存这个概念在判断一个指针表达式是否存在左值是时很有用。</p>
<h2 id="二、指针的算术运算">二、指针的算术运算</h2><p>摘自:<a href="http://bbs.csdn.net/topics/220070580" target="_blank" rel="external">http://bbs.csdn.net/topics/220070580</a></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/08/objective-c-preprocess.html">
                Objective-C预处理
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-08
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="预处理">预处理</h2><blockquote>
<p>预处理程序是编译过程的一部分，是可以识别散布在程序中的特定语句。预处理语句使用井号（＃）号标记在一行中第一个非空格字符</p>
</blockquote>
<p>预处理语句有以下几个语句</p>
<blockquote>
<p>#define 给符号名称制定程序常量<br>#import 导入<br>#ifdef、#endif、#else、ifndef 条件编译<br>#undef 消除特定名称的定义</p>
</blockquote>
<p>语句使用demo</p>
<p>macro.h：预处理，一些宏的定义</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  macro.h</span></span><br><span class="line"><span class="comment">//  Macro</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-7.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//宏定义</span></span><br><span class="line"><span class="preprocessor">#define OK 5</span></span><br><span class="line"><span class="preprocessor">#define NOOK 6</span></span><br><span class="line"><span class="preprocessor">#define PI 3.141592654</span></span><br><span class="line"><span class="preprocessor">#define TWO_PI 2.0 * PI</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#define AND &amp;&amp;</span></span><br><span class="line"><span class="preprocessor">#define OR ||</span></span><br><span class="line"><span class="preprocessor">#define EQUALS ==</span></span><br><span class="line"><span class="preprocessor">#define NOTEQUALS !=</span></span><br><span class="line"><span class="preprocessor">#define UP &gt;</span></span><br><span class="line"><span class="preprocessor">#define LOW <span class="title">&lt;</span><br><span class="line">#define mod %</span><br><span class="line">#define div /</span><br><span class="line"></span><br><span class="line">//判断闰年</span><br><span class="line">#define IS_LEAP_YEAR(year) year % 4 == 0 &amp;&amp; year % 100 != 0 || year % 400 == 0</span><br><span class="line"></span><br><span class="line">//平方</span><br><span class="line">#define SQUARE(x) (x) * (x)</span><br><span class="line"></span><br><span class="line">#define CIRCLE_AREA(raduis) [[[Circle alloc] init] area: raduis]</span><br><span class="line"></span><br><span class="line">#define MAX(a, b) ((a) &gt;</span> (b) ? (a) : (b))</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#define IPAD</span></span><br><span class="line"><span class="comment">//条件编译</span></span><br><span class="line"><span class="preprocessor">#ifdef IPAD</span></span><br><span class="line"><span class="preprocessor">#  define DEVICE <span class="title">"IPAD"</span></span></span><br><span class="line"><span class="preprocessor">#else</span></span><br><span class="line"><span class="preprocessor">#  define DEVICE <span class="title">"IPHONE"</span></span></span><br><span class="line"><span class="preprocessor">#endif</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//没啥逻辑，只是用下语法</span></span><br><span class="line"><span class="preprocessor">#if defined (IPAD)</span></span><br><span class="line"><span class="preprocessor">#  undef IPAD</span></span><br><span class="line"><span class="preprocessor">#elif !defined (IPAD)</span></span><br><span class="line"><span class="preprocessor">#  define IPAD</span></span><br><span class="line"><span class="preprocessor">#ele</span></span><br><span class="line"><span class="preprocessor">#  define IPHONE</span></span><br><span class="line"><span class="preprocessor">#endif</span></span><br></pre></td></tr></table></figure>
<p>圆类.h<br>Circle.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Circle.h</span></span><br><span class="line"><span class="comment">//  Macro</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-7.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Circle</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">@private</span></span><br><span class="line">    <span class="keyword">int</span> _raduis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">int</span> raduis;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">double</span>)area;</span><br><span class="line">- (<span class="keyword">double</span>)circumference;</span><br><span class="line">- (<span class="keyword">double</span>)area:(<span class="keyword">int</span>)raduis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>Circle.m<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Circle.m</span></span><br><span class="line"><span class="comment">//  Macro</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-7.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Circle.h"</span></span></span><br><span class="line"><span class="preprocessor">#include <span class="title">"macro.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Circle</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@synthesize</span> raduis = _raduis;</span><br><span class="line"></span><br><span class="line"><span class="comment">//面积</span></span><br><span class="line">- (<span class="keyword">double</span>)area</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> PI * _raduis * _raduis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//周长</span></span><br><span class="line">- (<span class="keyword">double</span>)circumference</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//return 2.0 * PI * _raduis;</span></span><br><span class="line">    <span class="keyword">return</span> TWO_PI * _raduis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">double</span>)area:(<span class="keyword">int</span>)raduis</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> PI * raduis * raduis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>test main.m<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  main.m</span></span><br><span class="line"><span class="comment">//  Macro</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xjliao on 14-5-7.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2014年 xjliao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#include <span class="title">"macro.h"</span></span></span><br><span class="line"><span class="preprocessor">#include <span class="title">"Circle.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// insert code here...</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"OK = %i"</span>, OK);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"NOOK = %i"</span>, NOOK);</span><br><span class="line">        </span><br><span class="line">        Circle *cir = [[Circle alloc] init];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> raduis = i;</span><br><span class="line">            [cir setRaduis: raduis];</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">double</span> area = [cir area];</span><br><span class="line">            <span class="keyword">double</span> circumference = cir<span class="variable">.circumference</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"area = %0.2f"</span>, area);</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"circumference = %0.2f"</span>, circumference);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (area EQUALS circumference AND raduis EQUALS <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"area == circumference"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (area UP circumference) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"area &gt; circumference"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (area LOW circumference)&#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"area &lt; circumference"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"unknown"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> year = <span class="number">2003</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (IS_LEAP_YEAR(year)) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"是闰年"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"不是闰年"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">double</span> x = <span class="number">5.25</span>;</span><br><span class="line">        <span class="keyword">double</span> xx = SQUARE(x);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"XX = %0.4f"</span>, xx);</span><br><span class="line">        <span class="comment">//使用宏定义求面积</span></span><br><span class="line">        <span class="keyword">double</span> areade = <span class="built_in">CIRCLE_AREA</span>(<span class="number">3</span>);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"areade = %0.2f"</span>, areade);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> max = MAX(<span class="number">100</span>, <span class="number">190</span>);        </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"max = %i"</span>, max);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSString</span> *device = @DEVICE;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"device = %@"</span>, device);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>result:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.488</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] OK = <span class="number">5</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.490</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] NOOK = <span class="number">6</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.491</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] area = <span class="number">3.14</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.491</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] circumference = <span class="number">6.28</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.491</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] area &lt; circumference</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.492</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] area = <span class="number">12.57</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.492</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] circumference = <span class="number">12.57</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.492</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] area == circumference</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.493</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] area = <span class="number">28.27</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.493</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] circumference = <span class="number">18.85</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.493</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] area &gt; circumference</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.494</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] 不是闰年</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.494</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] XX = <span class="number">27.5625</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.494</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] areade = <span class="number">28.27</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.495</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] max = <span class="number">190</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">13</span>:<span class="number">08</span>:<span class="number">05.495</span> Macro[<span class="number">3562</span>:<span class="number">303</span>] device = IPAD</span><br><span class="line">Program ended with <span class="built_in">exit</span> code: <span class="number">0</span></span><br></pre></td></tr></table></figure>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/06/objective-c-protocol.html">
                Objective-C协议与代理
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-06
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="协议">协议</h2><blockquote>
<p>&nbsp;&nbsp;协议是多个类共享得一个方法列表，协议中列出得方法没有<br>相应得实现，由其他类进行实现。类似java中得接口（interface）  </p>
</blockquote>
<p>定义协议：Prototol.h </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">Protocol</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@required</span></span><br><span class="line">- (<span class="keyword">void</span>)print1;</span><br><span class="line">- (<span class="keyword">void</span>)print2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line">- (<span class="keyword">void</span>)print3;</span><br><span class="line">- (<span class="keyword">void</span>)print4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>@protocoal：定义协议<br>@required：必须要现实得方法<br>@optional：可选实现得方法<br>协议也可以继承其他协议，在协议名后面加上&lt;协议名&gt;<br>类别也可以使用协议</p>
</blockquote>
<p>实现协议:<br>TestProtocol1.h</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Protocol.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">TestProtocol1</span> : <span class="title">NSObject</span> &lt;<span class="title">Protocol</span>, <span class="title">NSObject</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>在&lt;&gt;里面放入要实现得协议名，实现多个协议用“,”分隔，无需在定义协议中得方法了，直接在实现文件中实现即可  </p>
</blockquote>
<figure class="highlight objc"><figcaption><span>TestProtocol1.m</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"TestProtocol1.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">TestProtocol1</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)print1</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"p1"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)print2</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"p2"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>在这没有实现协议得可选方法  </p>
</blockquote>
<p>测试</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"TestProtocol.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        </span><br><span class="line">        TestProtocol *tp = [[TestProtocol alloc] init];</span><br><span class="line">        [tp print1];</span><br><span class="line">        [tp print2];</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">06</span> <span class="number">22</span>:<span class="number">51</span>:<span class="number">23.457</span> JF[<span class="number">2843</span>:<span class="number">303</span>] p1</span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">06</span> <span class="number">22</span>:<span class="number">51</span>:<span class="number">23.458</span> JF[<span class="number">2843</span>:<span class="number">303</span>] p2</span><br><span class="line">Program ended with <span class="built_in">exit</span> code:</span><br></pre></td></tr></table></figure>
<h2 id="代理">代理</h2><blockquote>
<p>协议也是种两个类之间得接口定义。定义了协议得类可以看作是将协议定义得方法代理给了实现他们得类。这样类得定义可以更为通用，因为具体得动作由代理类来实现。</p>
</blockquote>
<h2 id="非正式协议">非正式协议</h2><blockquote>
<p>&nbsp;&nbsp;非正式协议实际上是一个分类，列出了一组方法但没有实现他们。每个人都继承相同得根对象，因此，非正式分类通常是为根类定义得，有时，非正式协议也成为抽象（abstract）协议  </p>
</blockquote>
<p>伪代码</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="built_in">NSObject</span> (<span class="built_in">NSCOMparisonMethods</span>)</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)isEqualTo:(<span class="keyword">id</span>)object;</span><br><span class="line">- (<span class="built_in">BOOL</span>)isLessThanOrEqualTo:(<span class="keyword">id</span>)object;</span><br><span class="line">- (<span class="built_in">BOOL</span>)isLessThan:(<span class="keyword">id</span>)object;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>伪代码为NSObject类定义了一个名为NSComparisonMethods得分类。这项非正式协议列出了3个方法，可以将它们实现为协议得一部分。非正式协议实际上仅仅是一个名称下得一组方法。这在文档说明和模块化方法时，可能有所帮助。</p>
<p></p><p><br>声明非正式协议得类，可以不实现这些方法<br>声明正式协议得类必须要实现协议的方法  </p>
<p>Objective-c 2.0 在声明协议中@required，@optional 来取代正式协议和非正式协议。</p>
</blockquote>
<h2 id="合成对象">合成对象</h2><blockquote>
<p>合成对象其实就是java中得组合，在使用继承前，优先考虑组合是否能满足需求。<br>简单定义：就是一个类下面，声明了其他类得对象作为这个类下的实例变量。  </p>
</blockquote>
<p>伪代码<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Square</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    Rectangle *rect; <span class="comment">//组合了其他类的对象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">int</span>)setSide:(<span class="keyword">int</span>)s;</span><br><span class="line">- (<span class="keyword">int</span>)side;</span><br><span class="line">- (<span class="keyword">int</span>)area;</span><br><span class="line">- (<span class="keyword">int</span>)perimeter;</span><br></pre></td></tr></table></figure></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/05/05/objective-c-category-extension.html">
                Objective-C类别与类扩展
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-05-05
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Objective-c/">Objective-c</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="类别||类目||分类">类别||类目||分类</h2><blockquote>
<p>&nbsp;&nbsp;为现有类添加新得方法（不能添加实例变量，需要添加实例变量，就要进行使用扩展），但不类定义进行方法得添加，也不是对类进行继承，添加新方法</p>
</blockquote>
<p>Fraction.h</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Fraction</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)add;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>Frachtion.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Founation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Fraction.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Fraction</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)add</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"add"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>Fraction+Category.h</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"Fraction.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Fraction</span> (<span class="title">Category</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)sub;</span><br><span class="line">- (<span class="keyword">void</span>)mul;</span><br><span class="line">- (<span class="keyword">void</span>)div;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>Fraction+Category.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Fraction+Category.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Fraction</span> (<span class="title">Category</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)sub</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"sub"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)mul</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"mul"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)div</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"div"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>测试:main.m<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Fraction.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"Fraction+Category.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> *argv[])</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">		Fraction *f = [[Fraction alloc] init];</span><br><span class="line"></span><br><span class="line">		[f add];</span><br><span class="line">		[f sub];</span><br><span class="line">		[f mul];</span><br><span class="line">		[f div];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>运行结果</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2014-05-06 11:13:48.974 JF[541:303] add&#10;2014-05-06 11:13:48.976 JF[541:303] sub&#10;2014-05-06 11:13:48.976 JF[541:303] mul&#10;2014-05-06 11:13:48.977 JF[541:303] div&#10;Program ended with exit code: 0</span><br></pre></td></tr></table></figure>
<h2 id="类扩展">类扩展</h2><blockquote>
<p>&nbsp;&nbsp;可以说是匿名得类别<br>@interface Fraction ()<br>但他可以添加实例变量，类别不可以</p>
</blockquote>
<p>ExtensionTest.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ExtensionTest</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> _s1, _s2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">int</span> s1, s2;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)printS;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>类扩展文件：ExtensionTest_Et.h，<br>也可以在定义在ExtensionTest.m文件中。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"ExtensionTest.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ExtensionTest</span> ()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> _et1, _et2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">int</span> et1, et2;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)printEt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>ExtensionTest.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"ExtensionTest.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"ExtensionTest_Et.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> s = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ExtensionTest</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@synthesize</span> s1 = _s1, s2 = _s2;</span><br><span class="line"><span class="keyword">@synthesize</span> et1 = _et1, et2 = _et2;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)printS</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">extern</span> <span class="keyword">int</span> s;</span><br><span class="line">    [<span class="keyword">self</span> setS1: s];</span><br><span class="line">    s = <span class="number">101</span>;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> setS2: s];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"s1 = %i, s1 = %i"</span>, [<span class="keyword">self</span> s1], [<span class="keyword">self</span> s2]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)printEt</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"et1 = %i, et2 = %i"</span>, [<span class="keyword">self</span> et1], [<span class="keyword">self</span> et2]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>测试:main.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"ExtensionTest.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"ExtensionTest_Et.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> ExtensionTest et;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        </span><br><span class="line">        et *et = [[ExtensionTest alloc] init];</span><br><span class="line">        </span><br><span class="line">        [et printS];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//扩展得实例变量和方法</span></span><br><span class="line">        [et setEt1: <span class="number">134</span>];</span><br><span class="line">        [et setEt2: <span class="number">135</span>];</span><br><span class="line">        [et printEt];</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">57</span>:<span class="number">34.224</span> JF[<span class="number">1923</span>:<span class="number">303</span>] s1 = <span class="number">100</span>, s1 = <span class="number">101</span></span><br><span class="line"><span class="number">2014</span>-<span class="number">05</span>-<span class="number">06</span> <span class="number">15</span>:<span class="number">57</span>:<span class="number">34.224</span> JF[<span class="number">1923</span>:<span class="number">303</span>] et1 = <span class="number">134</span>, et2 = <span class="number">135</span></span><br><span class="line">Program ended with <span class="built_in">exit</span> code: <span class="number">0</span></span><br></pre></td></tr></table></figure>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/04/06/evian-Spider-Man-The-Amazing-Baby-&-me-2.html">
                evian Spider-Man - The Amazing Baby & me 2 创意广告
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-04-06
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/创意/">创意</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h3 id="evian_Spider-Man_-_The_Amazing_Baby_&amp;_me_2_创意广告">evian Spider-Man - The Amazing Baby &amp; me 2 创意广告</h3><video width="640" height="480" controls="controls" src="http://xjliao.qiniudn.com/videos/evian-Spider-Ma-The-Amazing-Baby-&-me-2.mp4" preload="preload" autoplay="autoplay">
</video>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/03/31/ios_developer_programs.html">
                IOS 开发者账号
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-03-31
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Ios/">Ios</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="IOS开发者账号类型及区别">IOS开发者账号类型及区别</h2><p>参考官网<br><a href="https://developer.apple.com/programs/start/ios/" target="_blank" rel="external">https://developer.apple.com/programs/start/ios/</a></p>
<p><img src="http://xjliao-images.qiniudn.com/compare_programs.png" alt=""></p>
<p>点击下面每行的<img src="http://xjliao-images.qiniudn.com/enroll_now.jpg" alt=""> 注册相应类型的开发者账号.<br><img src="http://xjliao-images.qiniudn.com/choosing_an_ios_developer_program.jpg" alt=""></p>
<h2 id="取消已在付款阶段的开发者账号注册">取消已在付款阶段的开发者账号注册</h2><p>你需要已申请好D-U-N-S® Number(邓白氏码)和apple id.才能进行如下步骤.</p>
<p>一. <font color="red">取消申请,如未申请请略过一,直接进入二.<br>.这次申请的情况比较特殊, 由于客户误操作,将原本需要申请为企业账号类型误操作申请为了公司账号类型并且已经到了付款这个步骤,无法手动取消了,由于需要取消,重新申请,所以请发邮件给他们,取消.<a href="https://developer.apple.com/contact/" target="_blank" rel="external">https://developer.apple.com/contact/</a></font></p>
<p><font color="blue">点击红色箭头方向上的蓝色字体字的链接</font><br><img src="http://xjliao-images.qiniudn.com/apple_developer_contact.jpg" alt=""></p>
<p>选择相应信息<br><img src="http://xjliao-images.qiniudn.com/099BEDED-3523-44CF-BED2-735719B614D8.jpg" alt=""><br>等待取消.进入二步骤</p>
<h2 id="企业开发者账号注册">企业开发者账号注册</h2><p>二:注册开发者账号<br>1.打开apple开发者中心网站(<a href="https://developer.apple.com" target="_blank" rel="external">https://developer.apple.com</a>), 点击箭头方向矩形方框内的Programs<br><img src="http://xjliao-images.qiniudn.com/A187F79B-5693-473C-AE39-FF82BFFA3429.jpg" alt=""><br>2.跟着标志提示一步一步点下去<br><img src="http://xjliao-images.qiniudn.com/E60AF95D-C308-47BF-926B-245C04A90A6B.jpg" alt=""><br><img src="http://xjliao-images.qiniudn.com/017F6CCB-FA90-4611-928F-A69B4ABF4094.jpg" alt=""><br><img src="http://xjliao-images.qiniudn.com/D636566E-D308-4244-B58A-8D446BC994F2.jpg" alt=""><br><img src="http://xjliao-images.qiniudn.com/1DB1AC01-3ABD-4336-826F-733FDAFD0310.jpg" alt=""><br>登录已有账号<br><img src="http://xjliao-images.qiniudn.com/1E085225-7B1F-4CD6-8326-B3DC3EF6BA2A.jpg" alt=""><br>正式进入申请流程, 请如实填写相关信息.  </p>
<p><font color="red">申请者身份确认</font><br><img src="http://xjliao-images.qiniudn.com/234B6735-BA18-44DA-A160-D9CFE34CC243.jpg" alt=""><br>根据申请者身份选择.一般情况都是公司员工去申请,所以选择1进行操作,所有表单字段必填.<br>注: 1.我有合法权力签署, 并代表我公司签署苹果开发者计划的法律协议和合同。可以通过以下的联系方式进行验证。<br>2.我是业主/创始人拥有的法律权力，代表我公司签署苹果开发者计划的法律协议和合同。</p>
<p>填完这一步, Continue,下一步填写您所在单位组织的信息<br><img src="http://xjliao-images.qiniudn.com/67FDD6FA-F575-4AEE-8DAD-521F88FFEC1F.jpg" alt=""><br>注(填写的单位组织信息请和D-U-N-S® Number(邓白氏码)一致, 否则将无法进入下一步,并出现与D&amp;B信息不一致的错误提示)</p>
<p>检查购买,填写信息并提交, 信息有误back修改<br><img src="http://xjliao-images.qiniudn.com/941610FB-8F5B-48FE-8D01-0E48D38538FD.jpg" alt=""><br>提交后,页面显示如下,显示即将处理注册,同时邮箱将收到一份申请注册请求响应信息, 等待审核信息, 并且人工电话核对信息<br><img src="http://xjliao-images.qiniudn.com/FF433CB5-4158-476D-B1FE-8A539F666A19.jpg" alt=""><br><img src="http://xjliao-images.qiniudn.com/BB206D1E-27E7-40C4-A728-4EEC500F5AA3.jpg" alt=""><br><img src="http://xjliao-images.qiniudn.com/8F045524-D19F-4264-B271-B0D7B9428EB0.jpg" alt=""><br>以下页面暂时无法截图,需等审核通过后再进行截图.</p>
<p>非特殊情况, 5天左右, 电话审核过后半个小时内既可知道结果. 注意邮箱.<br>如果信息审核通过, 将进入accept license agreement步骤, 这个步骤勾选下阅读同意协议即可<br>进入下一步将是购买和激活步骤,<br>进入购买页, 确认购买信息,  购买后,是跳转到appstore付款页,  付款仅支持VISA、MasterCard信用卡付款.<br>付款后——&gt;激活</p>
<p>此文word版<a href="http://7xi4gg.com1.z0.glb.clouddn.com/ios_enroll_program.docx" target="_blank" rel="external">http://7xi4gg.com1.z0.glb.clouddn.com/ios_enroll_program.docx</a></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/03/31/hadoop-2.2.0-eclipse-plugin-setup.html">
                hadoop-2.2.0 eclipse plugin setup
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-03-31
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Hadoop/">Hadoop</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>hadoop-2.2.0 eclipse plugin 安装</p>
<p>源码地址：<a href="https://github.com/winghc/hadoop2x-eclipse-plugin" target="_blank" rel="external">https://github.com/winghc/hadoop2x-eclipse-plugin</a><br>安装前请确保已安装好git,ant.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@lxjvl sf_D_DRIVE]<span class="comment"># git clone https://github.com/winghc/hadoop2x-eclipse-plugin.git </span></span><br><span class="line">[root@lxjvl sf_D_DRIVE]<span class="comment"># cd ./hadoop2x-eclipse-plugin/src/contrib/eclipse-plugin/</span></span><br><span class="line">[root@lxjvl sf_D_DRIVE]<span class="comment"># ant jar -Dversion=2.2.0 -Declipse.home=/media/sf_D_DRIVE/eclipses/eclipse-java-indigo-SR2_hd </span></span><br><span class="line">-Dhadoop.home=/home/lxj/hadoop-<span class="number">2.2</span>.<span class="number">0</span> </span><br><span class="line">[root@lxjvl eclipse-plugin]<span class="comment"># ls -l /media/sf_D_DRIVE/hadoop2x-eclipse-plugin/build/contrib/eclipse-plugin/</span></span><br><span class="line">总用量 <span class="number">23033</span></span><br><span class="line">drwxrwx---. <span class="number">1</span> root vboxsf        <span class="number">0</span> <span class="number">3</span>月  <span class="number">31</span> <span class="number">12</span>:<span class="number">21</span> classes</span><br><span class="line">drwxrwx---. <span class="number">1</span> root vboxsf        <span class="number">0</span> <span class="number">3</span>月  <span class="number">31</span> <span class="number">12</span>:<span class="number">08</span> examples</span><br><span class="line">-rwxrwx---. <span class="number">1</span> root vboxsf <span class="number">23568855</span> <span class="number">3</span>月  <span class="number">31</span> <span class="number">12</span>:<span class="number">21</span> hadoop-eclipse-plugin-<span class="number">2.2</span>.<span class="number">0</span>.jar</span><br><span class="line">drwxrwx---. <span class="number">1</span> root vboxsf    <span class="number">16384</span> <span class="number">3</span>月  <span class="number">31</span> <span class="number">12</span>:<span class="number">21</span> lib</span><br><span class="line">drwxrwx---. <span class="number">1</span> root vboxsf        <span class="number">0</span> <span class="number">3</span>月  <span class="number">31</span> <span class="number">12</span>:<span class="number">08</span> system</span><br><span class="line">drwxrwx---. <span class="number">1</span> root vboxsf        <span class="number">0</span> <span class="number">3</span>月  <span class="number">31</span> <span class="number">12</span>:<span class="number">08</span> <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>hadoop-eclipse-plugin-2.2.0.jar 这个就是编译好的eclipse的hadoop-2.2.0插件<br>拷到eclipse目录下的plugins目录可以了</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/03/21/hadoop-2.2.0-cluster-setup.html">
                Centos 6.5 hadoop 2.2.0 全分布式安装
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-03-21
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Linux/">Linux</a>

              
              
                , 
              

            
              <a href="/categories/Linux/Hadoop/">Hadoop</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>hadoop 2.2.0 cluster setup<br>环境：</p>
<p>操作系统:Centos 6.5<br>jdk:jdk1.7.0_51<br>hadoop版本:2.2.0  </p>
<blockquote>
<p>hostname &nbsp;&nbsp;       ip</p>
<p>master     192.168.1.180</p>
<p>slave1     192.168.1.181</p>
<p>slave2     192.168.1.182</p>
<p>slave3     192.168.1.183</p>
</blockquote>
<h2 id="前期系统环境配置">前期系统环境配置</h2><h3 id="设置主机名">设置主机名</h3><p>临时生效修改主机名，重启失效</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ hostname master</span><br></pre></td></tr></table></figure>
<p>永久生效修改主机名,需重启.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ vim /etc/sysconfig/network</span><br><span class="line"></span><br><span class="line">NETWORKING=yes</span><br><span class="line">HOSTNAME=master</span><br></pre></td></tr></table></figure>
<h3 id="设置ip">设置ip</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ vim /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line"></span><br><span class="line">DEVICE=eth0</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">UUID=<span class="number">390</span>e4922-<span class="number">0</span>d95-<span class="number">4</span>c34-<span class="number">9</span>dde-<span class="number">897</span>fb8acef0f</span><br><span class="line">ONBOOT=yes</span><br><span class="line">NM_CONTROLLED=yes</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">HWADDR=<span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:<span class="number">1</span>C:<span class="number">57</span>:<span class="number">24</span></span><br><span class="line">IPADDR=<span class="number">192.168</span>.<span class="number">1.180</span></span><br><span class="line">PREFIX=<span class="number">24</span></span><br><span class="line">GATEWAY=<span class="number">192.168</span>.<span class="number">1.1</span></span><br><span class="line">DNS1=<span class="number">192.168</span>.<span class="number">1.1</span></span><br><span class="line">DOMAIN=<span class="number">114.114</span>.<span class="number">114.114</span></span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=yes</span><br><span class="line">IPV6INIT=no</span><br><span class="line">NAME=<span class="string">"System eth0"</span></span><br><span class="line">LAST_CONNECT=<span class="number">1393996666</span></span><br></pre></td></tr></table></figure>
<h3 id="host_映射">host 映射</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ vim /etc/hosts</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>   localhost</span><br><span class="line"><span class="number">192.168</span>.<span class="number">1.180</span> master</span><br><span class="line"><span class="number">192.168</span>.<span class="number">1.181</span> slave1</span><br><span class="line"><span class="number">192.168</span>.<span class="number">1.182</span> slave2</span><br><span class="line"><span class="number">192.168</span>.<span class="number">1.183</span> slave3</span><br></pre></td></tr></table></figure>
<p>其他节点hosts改成这样。</p>
<h3 id="关闭防火墙">关闭防火墙</h3><p>开机启动关闭</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ sudo service iptables stop</span><br><span class="line">[lxj@master ~]$ sudo chkconfig iptables off</span><br></pre></td></tr></table></figure>
<h3 id="ssh_无密码登录，master_需要启动slave节点的相关进程">ssh 无密码登录，master 需要启动slave节点的相关进程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ ssh-keygen -t rsa -P <span class="string">''</span> <span class="operator">-f</span> ~/.ssh/id_rsa</span><br><span class="line">[lxj@master ~]$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>
<p>测试是否能无密码登录了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ ssh localhost</span><br></pre></td></tr></table></figure>
<p>如果以上操作完成后 还需要输入密码 请做一下操作<br>/home/用户名/.ssh  目录权限 700<br>/home/用户名/.ssh/authorized_keys 文件权限 600</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ chmod <span class="number">700</span> /home/lxj/.ssh</span><br><span class="line">[lxj@master ~]$ chmod <span class="number">600</span> /home/lxj/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>
<h3 id="拷贝公钥到其他slave节点">拷贝公钥到其他slave节点</h3><p>由于master主机公钥已写入authorized_keys授权文件，所以只要拷贝授权文件到其他slave节点即可</p>
<blockquote>
<p>注意节点.ssh目录和authorized_keys文件权限也分别要是700,600。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ scp /home/lxj/.ssh/authorized_keys lxj@slave1:/home/lxj/.ssh/</span><br><span class="line">[lxj@master ~]$ scp /home/lxj/.ssh/authorized_keys lxj@slave2:/home/lxj/.ssh/</span><br><span class="line">[lxj@master ~]$ scp /home/lxj/.ssh/authorized_keys lxj@slave3:/home/lxj/.ssh/</span><br></pre></td></tr></table></figure>
<p>测试是否可以无密码登录slave节点了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ ssh slave1</span><br><span class="line">[lxj@master ~]$ <span class="built_in">exit</span></span><br><span class="line">[lxj@master ~]$ ssh slave2</span><br><span class="line">[lxj@master ~]$ <span class="built_in">exit</span></span><br><span class="line">[lxj@master ~]$ ssh slave3</span><br></pre></td></tr></table></figure>
<p>可以的话，这样master无密码登录其他slave节点就配配置好了！  </p>
<h2 id="hadoop_配置文件">hadoop 配置文件</h2><p>先设置下环境变量  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/home/lxj/jdk1.<span class="number">7.0</span>_51</span><br><span class="line">CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar</span><br><span class="line"></span><br><span class="line">HADOOP_HOME=/home/lxj/hadoop-<span class="number">2.2</span>.<span class="number">0</span></span><br><span class="line">HADOOP_MAPRED_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line">HADOOP_COMMON_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line">HADOOP_HDFS_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line">YARN_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line">HADOOP_CONF_DIR=<span class="variable">$HADOOP_HOME</span>/etc/hadoop</span><br><span class="line">YARN_CONF_DIR=<span class="variable">$HADOOP_HOME</span>/etc/hadoop</span><br><span class="line"></span><br><span class="line">PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/sbin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME CLASSPATH HADOOP_HOME HADOOP_MAPRED_HOME HADOOP_COMMON_HOME HADOOP_HDFS_HOME YARN_HOME HADOOP_CONF_DIR YARN_CONF_DIR  PATH</span><br></pre></td></tr></table></figure>
<p>主要需修改的配置文件<br>我们先在master机器上修改这些配置文件，然后传到各个节点<br>hadoop 目录在~/hadoop-2.2.0</p>
<blockquote>
<p>hadoop-env.sh、core-site.xml、hdfs-site.xml、mapred-site.xml、yarn-env.sh、yarn-site.xml、masters、slaves</p>
</blockquote>
<p>以上配置文件，如果没有则自己新建 </p>
<blockquote>
<p>节点信息<br>NameNode: master,slave1<br>SecondaryNameNode: master,slave1<br>DataNode:slave1,slave2,slave3  </p>
</blockquote>
<h2 id="master_机器配置">master 机器配置</h2><h3 id="hadoop-env-sh_修改JAVA_HOME">hadoop-env.sh 修改JAVA_HOME</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$  <span class="built_in">cd</span> ~/hadoop-<span class="number">2.2</span>.<span class="number">0</span>/etc/hadoop</span><br><span class="line">[lxj@master hadoop]$ vim hadoop-env.sh</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># The only required environment variable is JAVA_HOME.  All others are&#10;# optional.  When running a distributed configuration it is best to&#10;# set JAVA_HOME in this file, so that it is correctly defined on&#10;# remote nodes.&#10;&#10;# The java implementation to use.&#10;export JAVA_HOME=/home/lxj/jdk-1.7.0_15</span><br></pre></td></tr></table></figure>
<h3 id="core-site-xml">core-site.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="pi">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">name</span>&gt;</span>fs.default.name<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">value</span>&gt;</span>hdfs://master:9000<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">value</span>&gt;</span>/home/lxj/hadoop/tmp<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="hdfs-site-xml">hdfs-site.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="pi">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:50090<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>fs.checkpoint.period<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>600<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>fs.checkpoint.size<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>67108894<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>file:/home/lxj/hadoop/hdfs/namenode<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>file:/home/lxj/hadoop/hdfs/datanode<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>false<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>3<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>true<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="mapred-site-xml">mapred-site.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="pi">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>mapred.job.tracker<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:9001<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="yarn-env-sh_修改JAVA_HOME">yarn-env.sh 修改JAVA_HOME</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># some Java parameters&#10;export JAVA_HOME=/home/lxj/jdk1.7.0_51&#10;if [ &#34;$JAVA_HOME&#34; != &#34;&#34; ]; then&#10;  #echo &#34;run java in $JAVA_HOME&#34;&#10;  JAVA_HOME=$JAVA_HOME&#10;fi</span><br></pre></td></tr></table></figure>
<p>6.yarn-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">name</span>&gt;</span>yarn.nodemanager.aux-servicex.mapreduce.shuffle.class<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">value</span>&gt;</span>org.apache.hadoop.mapred.ShuffleHandler<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">name</span>&gt;</span>yarn.resourcemanager.address<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:8032<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">name</span>&gt;</span>yarn.resourcemanager.scheduler.address<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:8030<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:8031<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">name</span>&gt;</span>yarn.resourcemanager.admin.address<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:8033<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">name</span>&gt;</span>yarn.resourcemanager.webapp.address<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">value</span>&gt;</span>master:8088<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line">```                                </span><br><span class="line"></span><br><span class="line">7.masters 添加master主机</span><br><span class="line">多个换行写</span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">master</span><br></pre></td></tr></table></figure>
<p>8.slaves 添加slave节点<br>当加入master时，master即当作NameNode又当作DataNode节点</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slave1  &#10;slave2&#10;slave3</span><br></pre></td></tr></table></figure>
<h2 id="slave_节点配置">slave 节点配置</h2><p>其他节点各拷贝一份。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ scp -r ~/hadoop-<span class="number">2.2</span>.<span class="number">0</span> lxj@slave1:/home/lxj/</span><br><span class="line">[lxj@master ~]$ scp -r ~/hadoop-<span class="number">2.2</span>.<span class="number">0</span> lxj@slave2:/home/lxj/</span><br><span class="line">[lxj@master ~]$ scp -r ~/hadoop-<span class="number">2.2</span>.<span class="number">0</span> lxj@slave3:/home/lxj/</span><br></pre></td></tr></table></figure>
<blockquote>
<p>slave节点的hadoop路径需和master的路径一样，当然系统环境需要保持一致。<br>只要将master主机的配置好的文件拷贝到各个节点即可。</p>
</blockquote>
<h2 id="hadoop_启动">hadoop 启动</h2><h3 id="格式化一个新的分布式文件系统">格式化一个新的分布式文件系统</h3><p>需要在master和slave1都要执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ hdfs namenode -format</span><br></pre></td></tr></table></figure>
<h3 id="启动hdfs和yarn">启动hdfs和yarn</h3><p>只需在master执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ start-dfs.sh</span><br><span class="line">[lxj@master ~]$ start-yarn.sh</span><br><span class="line">[lxj@master ~]$ mr-jobhistory-daemon.sh start historyserver</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lxj@mater ~]$ start-all.sh</span><br></pre></td></tr></table></figure>
<p>start-all.sh已废弃，不推荐使用！  </p>
<h3 id="测试">测试</h3><p>master 进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ jps</span><br><span class="line"><span class="number">11597</span> JobHistoryServer</span><br><span class="line"><span class="number">4529</span> Jps</span><br><span class="line"><span class="number">4460</span> ResourceManager</span><br><span class="line"><span class="number">4293</span> NameNode</span><br><span class="line"><span class="number">4377</span> SecondaryNameNode</span><br></pre></td></tr></table></figure>
<p>slaves进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ jps</span><br><span class="line"><span class="number">1941</span> DataNode</span><br><span class="line"><span class="number">2176</span> Jps</span><br><span class="line"><span class="number">2046</span> NodeManager</span><br></pre></td></tr></table></figure>
<p>创建输入目录和文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ hdfs dfs -mkdir /input</span><br><span class="line">[lxj@master ~]$ vim ./<span class="built_in">test</span></span><br><span class="line">hello hadoop <span class="built_in">test</span></span><br><span class="line">`</span><br></pre></td></tr></table></figure>
<p>拷贝文件到hdfs文系统，运行wordcount程序计算输入文件的单词出现次数  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[lxj@master ~]$ hdfs dfs -copyFromLocal ./<span class="built_in">test</span> /input </span><br><span class="line">[lxj@master ~]$ hadoop jar /home/lxj/hadoop-<span class="number">2.2</span>.<span class="number">0</span>/share/hadoop/mapreduce/hadoop-mapreduce-examples-<span class="number">2.2</span>.<span class="number">0</span>.jar wordcount /input/ /out</span><br><span class="line">[lxj@master ~]$ hdfs dfs -cat /out/*</span><br><span class="line">hadoop  <span class="number">1</span></span><br><span class="line">hello   <span class="number">1</span></span><br><span class="line"><span class="built_in">test</span>    <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>搞了下ha federation qjm 配置，没起来，还是从基础配置开始吧，以后在扩展。 </p>
<p>其他主题:<a href="!--￼27--&gt;/2014/03/31/hadoop-2.2.0-eclipse-plugin-setup.html">eclipse安装hadoop-2.2.0插件</a></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/03/19/jekyll-github.html">
                jekyll+github 搭建博客
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-03-19
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Ruby/">Ruby</a>

              
              
                , 
              

            
              <a href="/categories/Ruby/Jekyll/">Jekyll</a>

              
              
                , 
              

            
              <a href="/categories/Ruby/Jekyll/Github/">Github</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="gitHub">gitHub</h2><h3 id="注册github账户">注册github账户</h3><p><a href="https://github.com" target="_blank" rel="external">https://github.com</a></p>
<h3 id="创建Repository">创建Repository</h3><p>创建的repository,名称格式:<br>用户名.github.io<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username.github.io</span><br></pre></td></tr></table></figure><br><img src="http://xjliao.qiniudn.com/img/jekyll-github/create-repository.jpg" alt="create-repository"></p>
<h2 id="jekyll">jekyll</h2><p>jekyll是一个静态网站生成器</p>
<p>官网：<a href="http://jekyllrb.com/" target="_blank" rel="external">http://jekyllrb.com/</a>,中文网站：<a href="http://jekyllcn.com/" target="_blank" rel="external">http://jekyllcn.com/</a></p>
<h3 id="jekyll安装">jekyll安装</h3><h4 id="jekyll安装环境:">jekyll安装环境:</h4><ul>
<li>rvm</li>
<li>Ruby</li>
<li>RubyGems</li>
<li>Linux，Unix，or Mac OS X</li>
</ul>
<h5 id="rvm_安装">rvm 安装</h5><p>rvm是ruby的管理器<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -L https://get.rvm.io | bash <span class="operator">-s</span> stable</span><br></pre></td></tr></table></figure><br>安装期间，需要root权限，如果需要本终端生效的话，执行下列命令，新开终端无需执行。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> ~/.rvm/scripts/rvm</span><br></pre></td></tr></table></figure><br>检查是否安装成功<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rvm -v</span><br></pre></td></tr></table></figure><br>如果有显示rvm版本信息，则安装成功</p>
<h5 id="ruby安装">ruby安装</h5><p>安装版本为1.9.3<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rvm install <span class="number">1.9</span>.<span class="number">3</span></span><br></pre></td></tr></table></figure><br>可能时间比较长,安装完成测试<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rvm -v</span><br></pre></td></tr></table></figure><br>安装完后，RubyGems同时也安装完成<br>测试<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gem -v</span><br></pre></td></tr></table></figure><br>由于RubyGems默认源速度慢，修改为淘宝源<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gem <span class="built_in">source</span> <span class="operator">-a</span> http://ruby.taobao.org</span><br><span class="line">$ gem <span class="built_in">source</span> -r https://rubygems.org/</span><br></pre></td></tr></table></figure></p>
<h3 id="jekyll安装-1">jekyll安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gem install jekyll</span><br></pre></td></tr></table></figure>
<h4 id="测试下">测试下</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ jekyll -v</span><br></pre></td></tr></table></figure>
<h3 id="新建站点">新建站点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ jekyll new blog</span><br></pre></td></tr></table></figure>
<p>将在本目录生成目录名为blog，里面为jekyll所需文件框架</p>
<h4 id="测试新建站点">测试新建站点</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ./blog &amp;&amp; jekyll server</span><br></pre></td></tr></table></figure>
<p>可以通过访问localhost:4000验证启动是否成功。<br>如果看到下面这样的页面，就表示成功了！<br><img src="http://xjliao.qiniudn.com/img/jekyll-github/jekyll-server-succ.png" alt="jekyll-server-succ"></p>
<h3 id="jekyll主题更换">jekyll主题更换</h3><p>官方推荐主题的：<a href="https://github.com/jekyll/jekyll/wiki/Sites" target="_blank" rel="external">https://github.com/jekyll/jekyll/wiki/Sites</a><br>从github上面把自己喜欢的git clone下来就行了！<br>jekyll默认主题和推荐主题可能不符合你的口味，你可以使用其他主题，如：<a href="http://jekyllbootstrap.com/" target="_blank" rel="external">jekyl bootstrap</a>、<a href="http://jekyllthemes.org/" target="_blank" rel="external">jekyll themes</a><br>不过我不大喜欢！我的是<a href="http://89ao.info/" target="_blank" rel="external">89ao.info</a>的主题。<br>github地址:<a href="https://github.com/89ao/89ao.github.io" target="_blank" rel="external">https://github.com/89ao/89ao.github.io</a><br>接下来，我就这个主题，github部署jekyll</p>
<h2 id="github部署jekyll">github部署jekyll</h2><h3 id="项目克隆到本地">项目克隆到本地</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> git@github.com:<span class="number">89</span>ao/<span class="number">89</span>ao.github.io.git</span><br></pre></td></tr></table></figure>
<p>默认在当前目录创建和Repository名称一样的目录，如果要修改，则在后面加上目录名即可<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> git@github.com:<span class="number">89</span>ao/<span class="number">89</span>ao.github.io.git xjliao.github.io</span><br></pre></td></tr></table></figure></p>
<p>我们看下xjliao.github.io目录里的_config.yml，这是我修改之后的<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">markdown: redcarpet&#10;permalink: /:title/&#10;url: http://xjliao.me &#10;name: xjliao.me &#10;author: xjliao&#10;qq: 909012329 &#10;email: lxj990@gmail.com &#10;duoshuo: xjliao &#10;weibo: lxj990@gmail.com &#10;github: xjliao&#10;pygments: true&#10;safe: true&#10;paginate: 30&#10;about: &#34;&#34;</span><br></pre></td></tr></table></figure><br>主要是些配置信息，可以通过如在html、markdown文件里直接引用，稍微解释下配置信息：</p>
<blockquote>
<p>markdown 渲染引擎，有redcarpet，rdiscount等，要使用，你确定你已经安装过。<br>安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gem install redcarpet</span><br><span class="line">$ gem install rdiscount</span><br></pre></td></tr></table></figure><br>注意冒号后面必须要加一个空格，否则启动会报错</p>
<p>permalink 永久链接 在生成文章事，是按照这个设置的格式生成目录和文件</p>
<p>url 网址</p>
<p>pygments 是否启用pygments代码高亮</p>
<p>safe 安全连接</p>
<p>paginate 分页，一页显示多少条文章</p>
</blockquote>
<p>其他详细，<a href="http://jekyllcn.com/docs/home/" target="_blank" rel="external">jekyll documentation</a></p>
<h3 id="推送到xjliao-github-io">推送到xjliao.github.io</h3><p>添加自己的repository并别名为xjliao<br>推送到自己的主线分支版本,注意使用ssh，需要把本地ssh公钥拷贝至github<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git remote add xjliao git@github.com:xjliao/xjliao.github.io.git</span><br><span class="line">$ git push xjliao master</span><br></pre></td></tr></table></figure></p>
<p>10分钟左右访问<a href="http://xjliao.github.io" target="_blank" rel="external">http://xjliao.github.io</a> 就ok了</p>
<h2 id="Pygments_语法高亮">Pygments 语法高亮</h2><p><a href="https://pypi.python.org/pypi/Pygments" title="download" target="_blank" rel="external">下载地址</a> 支持100多种<a href="http://pygments.org/languages/" target="_blank" rel="external">语言</a> 样式<a href="http://pygments.org/demo/" target="_blank" rel="external">demo</a></p>
<p>安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://pypi.python.org/packages/<span class="built_in">source</span>/P/Pygments/Pygments-<span class="number">1.6</span>.tar.gz<span class="comment">#md5=a18feedf6ffd0b0cc8c8b0fbdb2027b1</span></span><br><span class="line">$ tar -zxvf ./Pygments-<span class="number">1.6</span>.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> ./Pygments-<span class="number">1.6</span></span><br><span class="line">$ python setup.py install</span><br><span class="line">$ pygmentize -S monokai <span class="operator">-f</span> html <span class="operator">-a</span> pre &gt; pygments.css</span><br></pre></td></tr></table></figure>
<p>-S 指定样式 -f 格式的类型 -a 一个特定的格式</p>
<p>将生成的pygments.css 拷贝到jekyll 目录(可以里面的随意目录)，我就发放到和jekyll主题的css样式文件一个目录吧，然后修改 default.html 默认模板，删除默认高亮样式，加入pygments.css样式。<br>这个jekyll的主题样式因为与pygments有些冲突，删除了下面两行就可以了</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">pre</span>,<span class="tag">code</span><span class="rules">&#123;<span class="rule"><span class="attribute">font-family</span>:<span class="value">Menlo,<span class="string">"Andale Mono"</span>,Consolas,<span class="string">"Courier New"</span>,Monaco,monospace</span></span>;<span class="rule"><span class="attribute">font-size</span>:<span class="value"><span class="number">13px</span></span></span>;&#125;</span></span><br><span class="line"><span class="tag">code</span><span class="rules">&#123;<span class="rule"><span class="attribute">background-color</span>:<span class="value"><span class="hexcolor">#D0D0D0</span></span></span>;&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="github_绑定域名">github 绑定域名</h2><p>在jekyll根目录新增或修改CNAME文件，里面添加上你的域名</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xjliao.me</span><br></pre></td></tr></table></figure>
<h2 id="域名注册_DNS设置_A记录绑定">域名注册 DNS设置 A记录绑定</h2><p>推荐号称全球最大的域名注册商<a href="http://www.godaddy.com/" target="_blank" rel="external">godaddy</a>上购买，支持支付宝付款，有较多优惠码，就算没有也比国内的便宜点！<br>购买注册就不多讲了，主要讲下指定A记录和DNS解析</p>
<p>进入domains管理界面选择域名设置DNS<br><img src="http://xjliao.qiniudn.com/img/jekyll-github/godaddy-set-dns.png" alt="DNSSET"><br>添加DNS，这里使用的是dnspod的解析服务<br><img src="http://xjliao.qiniudn.com/img/jekyll-github/godaddy-set-dns-dnspod.png" alt="DNSSETPOD"><br>然后登陆dnspod添加下要设置A记录的域名<br><img src="http://xjliao.qiniudn.com/img/jekyll-github/dns-pod-add-domain.png" alt="DNSSETPOD"><br>点击域名进入A记录设置界面<br><img src="http://xjliao.qiniudn.com/img/jekyll-github/dns-pod-add-a-record.png" alt="DNSSETPOD"><br>主机记录填写值<br>@ 直接解析主域名 xjliao.me、wwww 解析后的域名为 www.xjliao.me、<em> 泛解析，匹配其他所有域名 </em>.xjliao.me</p>
<p>记录类型为A记录，记录值为usrename.github.io的ip，ping下就知道了。<br>然后，就没有然后了，奥，对了，要保存！稍等片刻即可了！  </p>
<p>访问username.github.io 访问指向了绑定的域名 username.github.com也可以！就这样了</p>
<p>其他参考资料<br><a href="http://jekyllrb.com/" target="_blank" rel="external">jekyll</a>:<a href="http://jekyllrb.com/" target="_blank" rel="external">http://jekyllrb.com/</a><br><a href="http://wowubuntu.com/markdown/" target="_blank" rel="external">markdown</a>:<a href="http://wowubuntu.com/markdown/" target="_blank" rel="external">http://wowubuntu.com/markdown/</a><br><a href="http://pygments.org/" target="_blank" rel="external">pygments</a>:<a href="http://pygments.org/" target="_blank" rel="external">http://pygments.org/</a></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/03/19/linux-ssh-nopwd-login.html">
                ssh 无密码登陆
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-03-19
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Linux/">Linux</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>无密码登陆远程主机,需要将本地主机的公钥内容加入到远程主机的authorized_keys文件中<br>本地生成公钥(注:此操作中如果没有相应目录或文件,请手动创建,并且你必须已经知道远程主机的账户密码)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">xjl:~ xjliao$ ssh-keygen -t rsa -P <span class="string">''</span> <span class="operator">-f</span> ~/.ssh/id_rsa</span><br><span class="line">xjl:~ xjliao$ scp ./.ssh/id_rsa.pub xjliao@<span class="number">106.186</span>.<span class="number">19.59</span>:/home/xjliao/</span><br><span class="line">xjliao@<span class="number">106.186</span>.<span class="number">19.59</span><span class="string">'s password: </span><br><span class="line">id_rsa.pub                                                                                                                  100% 219</span><br><span class="line">xjl:~ xjliao$ ssh 106.186.19.59</span><br><span class="line">Last login: Wed Oct 22 09:25:00 2014 from 49.65.251.185</span><br><span class="line">[xjliao@li539-59 ~]$ cat id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">[xjliao@li539-59 ~]$ chmod 700 ~/.ssh</span><br><span class="line">[xjliao@li539-59 ~]$ chmod 600 ~/.ssh/authorized_keys</span><br><span class="line">[xjliao@li539-59 ~] exit</span><br><span class="line">xjl:~ xjliao$ ssh 106.186.19.59</span><br><span class="line">Last login: Wed Oct 22 09:25:00 2014 from 49.65.251.185</span></span><br></pre></td></tr></table></figure>
<p>哦了</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
  </div>

  
  <div class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/">&laquo;</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </div>


        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <div class="site-overview">
        <div class="site-author motion-element">
          <img class="site-author-image" src="/images/avatar.png" alt="xjliao" />
          <p class="site-author-name">xjliao</p>
        </div>
        <p class="site-description motion-element">A app & golang developer guy.</p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">82</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">31</span>
              <span class="site-state-item-name">categories</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">27</span>
              <span class="site-state-item-name">tags</span>
              </a>
          </div>

        </div>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml">
              <i class="menu-item-icon icon-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
              <a href="https://github.com/xjliao" target="_blank">GitHub</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://twitter.com/lxj12323" target="_blank">Twitter</a>
            </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

      </div>

      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp;  2013 - 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">xjliao</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.3"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.3"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.3" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  
  
  

  




  
  
  <script type="text/javascript" src="/js/analytics_google-analytics.js?v=0.4.3"></script>


</body>
</html>
